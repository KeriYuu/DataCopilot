{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for Virginia", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "earned_premium": 14338793.39}, {"policy_year": 2020, "earned_premium": 16431437.6}, {"policy_year": 2021, "earned_premium": 11190360.82}, {"policy_year": 2022, "earned_premium": 8834590.76}, {"policy_year": 2023, "earned_premium": 10135374.5}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 51.89402762309435}, {"class_code": "5183", "pure_premium": 49.836514945736035}, {"class_code": "5190", "pure_premium": 43.28508247333897}, {"class_code": "5506", "pure_premium": 43.08539538354736}, {"class_code": "8810", "pure_premium": 36.937337266178616}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total claim_count for Texas?", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE state = 'TX'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claim_count": 6799}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"class_code": "8810", "loss_ratio": 4.007111516755467}, {"class_code": "8742", "loss_ratio": 2.134132359460026}, {"class_code": "8017", "loss_ratio": 2.080447183516673}, {"class_code": "8820", "loss_ratio": 1.1063716253286444}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IL", "coverage_type": "Workers Compensation", "frequency": 0.00540555548697377}, {"state": "IL", "coverage_type": "General Liability", "frequency": 0.004787550378600992}, {"state": "IL", "coverage_type": "Commercial Property", "frequency": 0.0047853414234455575}, {"state": "IL", "coverage_type": "Commercial Auto", "frequency": 0.004596174482039275}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in PA", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'PA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_written_premium": 19882128.55}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}, {"state": "WA", "coverage_type": "Commercial Auto", "frequency": 0.006329788550197812}, {"state": "WA", "coverage_type": "Commercial Property", "frequency": 0.005438868989558347}, {"state": "WA", "coverage_type": "General Liability", "frequency": 0.005434264198009928}, {"state": "WA", "coverage_type": "Workers Compensation", "frequency": 0.004706871354840151}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.785177930085155}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IL", "coverage_type": "Workers Compensation", "frequency": 0.00540555548697377}, {"state": "IL", "coverage_type": "General Liability", "frequency": 0.004787550378600992}, {"state": "IL", "coverage_type": "Commercial Property", "frequency": 0.0047853414234455575}, {"state": "IL", "coverage_type": "Commercial Auto", "frequency": 0.004596174482039275}, {"state": "IN", "coverage_type": "Workers Compensation", "frequency": 0.006140999961541943}, {"state": "IN", "coverage_type": "Commercial Auto", "frequency": 0.005220633794959725}, {"state": "IN", "coverage_type": "General Liability", "frequency": 0.005183853945184153}, {"state": "IN", "coverage_type": "Commercial Property", "frequency": 0.004623384416942954}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2021?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.6176000914879978}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "TN", "coverage_type": "General Liability", "frequency": 0.005702595453595276}, {"state": "TN", "coverage_type": "Commercial Property", "frequency": 0.00499713846913048}, {"state": "TN", "coverage_type": "Workers Compensation", "frequency": 0.004349168053315909}, {"state": "TN", "coverage_type": "Commercial Auto", "frequency": 0.004255940076363725}, {"state": "WI", "coverage_type": "Commercial Property", "frequency": 0.005893619245835043}, {"state": "WI", "coverage_type": "Commercial Auto", "frequency": 0.005662830159835041}, {"state": "WI", "coverage_type": "Workers Compensation", "frequency": 0.005117575849296508}, {"state": "WI", "coverage_type": "General Liability", "frequency": 0.004776777591583218}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8820", "pure_premium": 46.78005886503411}, {"class_code": "5506", "pure_premium": 43.68825442086105}, {"class_code": "8810", "pure_premium": 37.684764668798614}, {"class_code": "9015", "pure_premium": 37.06410294297614}, {"class_code": "8017", "pure_premium": 35.174899049762104}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TN", "average_premium": 5487.837104884514}, {"state": "WA", "average_premium": 5419.252912436548}, {"state": "PA", "average_premium": 5404.408096346849}, {"state": "GA", "average_premium": 5330.874493071984}, {"state": "AZ", "average_premium": 5270.510482822656}, {"state": "TX", "average_premium": 5195.763139375354}, {"state": "CA", "average_premium": 5187.9085968448735}, {"state": "IN", "average_premium": 5165.71814018043}, {"state": "VA", "average_premium": 5007.9261217645535}, {"state": "FL", "average_premium": 4993.662469619444}, {"state": "NY", "average_premium": 4971.202810725258}, {"state": "MO", "average_premium": 4912.066315152563}, {"state": "NC", "average_premium": 4811.4407468595355}, {"state": "IL", "average_premium": 4810.454197539957}, {"state": "MA", "average_premium": 4729.088077302864}, {"state": "OH", "average_premium": 4581.627278552834}, {"state": "MI", "average_premium": 4575.9549949924885}, {"state": "MD", "average_premium": 4520.112904604051}, {"state": "WI", "average_premium": 4516.574014858381}, {"state": "NJ", "average_premium": 4506.759422212862}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "OH", "coverage_type": "Workers Compensation", "frequency": 0.006833538373300537}, {"state": "OH", "coverage_type": "Commercial Property", "frequency": 0.004644885713748235}, {"state": "OH", "coverage_type": "General Liability", "frequency": 0.004619240140061332}, {"state": "OH", "coverage_type": "Commercial Auto", "frequency": 0.004316815239931538}, {"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 49.67372498573775}, {"class_code": "9015", "pure_premium": 42.53804171971368}, {"class_code": "8810", "pure_premium": 38.53751093410779}, {"class_code": "8820", "pure_premium": 37.938143644216616}, {"class_code": "5506", "pure_premium": 37.78266611361865}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in OH for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1444}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10", "ground_truth": {"success": true, "row_count": 10, "data": [{"state": "TN", "total_written_premium": 72466888.97}, {"state": "OH", "total_written_premium": 68637358.26}, {"state": "WA", "total_written_premium": 68325940.72}, {"state": "AZ", "total_written_premium": 68116077.48}, {"state": "PA", "total_written_premium": 67311902.84}, {"state": "MA", "total_written_premium": 67049010.76}, {"state": "IL", "total_written_premium": 65311536.64}, {"state": "TX", "total_written_premium": 64380701.06}, {"state": "NJ", "total_written_premium": 64194281.21}, {"state": "NC", "total_written_premium": 63198274.21}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for CA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'CA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 37.676420942517574}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "General Liability", "policy_count": 64479}, {"coverage_type": "Commercial Property", "policy_count": 63851}, {"coverage_type": "Workers Compensation", "policy_count": 63388}, {"coverage_type": "Commercial Auto", "policy_count": 61680}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for MI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 41.65446451508064}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in VA for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1155}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'West'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_premium": 4988.978559496098}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IL", "paid_loss_ratio": 0.6656084286471571}, {"state": "WI", "paid_loss_ratio": 0.649880308491589}, {"state": "TX", "paid_loss_ratio": 0.6365016152009015}, {"state": "NJ", "paid_loss_ratio": 0.6334580352025554}, {"state": "TN", "paid_loss_ratio": 0.6252360868915836}, {"state": "GA", "paid_loss_ratio": 0.6228810480946463}, {"state": "MA", "paid_loss_ratio": 0.6140812956355586}, {"state": "VA", "paid_loss_ratio": 0.6088244274113939}, {"state": "MI", "paid_loss_ratio": 0.5982253384452179}, {"state": "IN", "paid_loss_ratio": 0.59453587121206}, {"state": "PA", "paid_loss_ratio": 0.5940486067034554}, {"state": "OH", "paid_loss_ratio": 0.5826399525883914}, {"state": "NY", "paid_loss_ratio": 0.5782333868674466}, {"state": "MO", "paid_loss_ratio": 0.574488033915724}, {"state": "FL", "paid_loss_ratio": 0.5721854822888148}, {"state": "MD", "paid_loss_ratio": 0.5629059676728803}, {"state": "NC", "paid_loss_ratio": 0.5610174722968836}, {"state": "CA", "paid_loss_ratio": 0.5525875028003563}, {"state": "AZ", "paid_loss_ratio": 0.5382113627590083}, {"state": "WA", "paid_loss_ratio": 0.5371712064131023}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for IN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'IN'", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8073.489258026951}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for MA in 2021", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 0.9361595127199636}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "9015", "loss_ratio": 14.4685936102383}, {"class_code": "5183", "loss_ratio": 3.496444718454583}, {"class_code": "8820", "loss_ratio": 1.6014225916385811}, {"class_code": "8810", "loss_ratio": 0.9792943319394031}, {"class_code": "5506", "loss_ratio": 0.7241558247551937}, {"class_code": "8017", "loss_ratio": 0.6952960882601866}, {"class_code": "8742", "loss_ratio": 0.6277768617064645}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "5190", "loss_ratio": 2.4775360017353383}, {"class_code": "9015", "loss_ratio": 1.5395755372376412}, {"class_code": "8017", "loss_ratio": 0.7174416625816417}, {"class_code": "5506", "loss_ratio": 0.6822979141179327}, {"class_code": "8810", "loss_ratio": 0.5473869295851361}, {"class_code": "8742", "loss_ratio": 0.443939203885203}, {"class_code": "8820", "loss_ratio": 0.00893116929935265}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "5190", "loss_ratio": 1.1777135225692248}, {"class_code": "8820", "loss_ratio": 0.9483602193306517}, {"class_code": "8017", "loss_ratio": 0.9076906624533189}, {"class_code": "8810", "loss_ratio": 0.8312649398356425}, {"class_code": "5506", "loss_ratio": 0.4728708289721704}, {"class_code": "5183", "loss_ratio": 0.45277498811803457}, {"class_code": "8742", "loss_ratio": 0.02348753585584333}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "CA", "loss_ratio": 0.9683335985067021}, {"state": "IL", "loss_ratio": 0.9298506191879081}, {"state": "GA", "loss_ratio": 0.9296919447230777}, {"state": "MI", "loss_ratio": 0.9251202340922515}, {"state": "MO", "loss_ratio": 0.8901141038311196}, {"state": "NY", "loss_ratio": 0.8880840135453197}, {"state": "TN", "loss_ratio": 0.8863192304876208}, {"state": "MD", "loss_ratio": 0.8633252774686468}, {"state": "PA", "loss_ratio": 0.8600276950954684}, {"state": "IN", "loss_ratio": 0.8442810394365661}, {"state": "NC", "loss_ratio": 0.8274711262610789}, {"state": "NJ", "loss_ratio": 0.824047940023472}, {"state": "FL", "loss_ratio": 0.8037234735233876}, {"state": "TX", "loss_ratio": 0.8015749087938548}, {"state": "VA", "loss_ratio": 0.8002005336589315}, {"state": "OH", "loss_ratio": 0.7801738224237221}, {"state": "AZ", "loss_ratio": 0.7738973010372888}, {"state": "MA", "loss_ratio": 0.7380809431912718}, {"state": "WI", "loss_ratio": 0.69588506963754}, {"state": "WA", "loss_ratio": 0.67705912225188}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "FL", "coverage_type": "Commercial Property", "frequency": 0.005662996360472919}, {"state": "FL", "coverage_type": "General Liability", "frequency": 0.004952392626736267}, {"state": "FL", "coverage_type": "Commercial Auto", "frequency": 0.004882603238195369}, {"state": "FL", "coverage_type": "Workers Compensation", "frequency": 0.0048681784090739266}, {"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8017", "loss_ratio": 0.8186423809168404}, {"class_code": "8810", "loss_ratio": 0.8170132186239819}, {"class_code": "9015", "loss_ratio": 0.808349495370977}, {"class_code": "5190", "loss_ratio": 0.8030004927646215}, {"class_code": "5183", "loss_ratio": 0.793463638744717}, {"class_code": "8742", "loss_ratio": 0.7922562362105812}, {"class_code": "8820", "loss_ratio": 0.7873688351977517}, {"class_code": "5506", "loss_ratio": 0.744577786250857}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7338.930260162602}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "5506", "loss_ratio": 2.140540991805445}, {"class_code": "9015", "loss_ratio": 1.214752918718732}, {"class_code": "8742", "loss_ratio": 1.1103794496647068}, {"class_code": "8810", "loss_ratio": 0.7446196557274398}, {"class_code": "5183", "loss_ratio": 0.6187226623152915}, {"class_code": "5190", "loss_ratio": 0.5352351991450037}, {"class_code": "8017", "loss_ratio": 0.3272453823142657}, {"class_code": "8820", "loss_ratio": 0.31535279468476407}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in TX for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1538}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for MI?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.49758912443507414}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "9015", "pure_premium": 52.536261572323696}, {"class_code": "5506", "pure_premium": 41.702236662791094}, {"class_code": "5190", "pure_premium": 41.255104638387046}, {"class_code": "8017", "pure_premium": 38.710275306589814}, {"class_code": "8810", "pure_premium": 35.61631873123105}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4949.626187915278}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "CA", "loss_ratio": 0.9683335985067021}, {"state": "IL", "loss_ratio": 0.9298506191879081}, {"state": "GA", "loss_ratio": 0.9296919447230777}, {"state": "MI", "loss_ratio": 0.9251202340922515}, {"state": "MO", "loss_ratio": 0.8901141038311196}, {"state": "NY", "loss_ratio": 0.8880840135453197}, {"state": "TN", "loss_ratio": 0.8863192304876208}, {"state": "MD", "loss_ratio": 0.8633252774686468}, {"state": "PA", "loss_ratio": 0.8600276950954684}, {"state": "IN", "loss_ratio": 0.8442810394365661}, {"state": "NC", "loss_ratio": 0.8274711262610789}, {"state": "NJ", "loss_ratio": 0.824047940023472}, {"state": "FL", "loss_ratio": 0.8037234735233876}, {"state": "TX", "loss_ratio": 0.8015749087938548}, {"state": "VA", "loss_ratio": 0.8002005336589315}, {"state": "OH", "loss_ratio": 0.7801738224237221}, {"state": "AZ", "loss_ratio": 0.7738973010372888}, {"state": "MA", "loss_ratio": 0.7380809431912718}, {"state": "WI", "loss_ratio": 0.69588506963754}, {"state": "WA", "loss_ratio": 0.67705912225188}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Workers Compensation in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7642.194051752921}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2022?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 1.0066421850484701}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8810", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 1.0153420254864853}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5183", "loss_ratio": 5.240595979649524}, {"class_code": "8810", "loss_ratio": 1.4048224552395354}, {"class_code": "9015", "loss_ratio": 1.0627560857834564}, {"class_code": "8017", "loss_ratio": 0.8894189107013811}, {"class_code": "5190", "loss_ratio": 0.777301403428917}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2022?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 1.0066421850484701}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5183", "loss_ratio": 7.329786678689225}, {"class_code": "8017", "loss_ratio": 2.244529385429612}, {"class_code": "5190", "loss_ratio": 0.6585742279084005}, {"class_code": "8820", "loss_ratio": 0.06957151673506773}, {"class_code": "8742", "loss_ratio": 0.0006969889326017302}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2022?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.49831821431370066}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "5506", "loss_ratio": 1.506967405169131}, {"class_code": "8017", "loss_ratio": 1.1772455351239546}, {"class_code": "8820", "loss_ratio": 0.9728000361829842}, {"class_code": "8742", "loss_ratio": 0.7627020575466571}, {"class_code": "8810", "loss_ratio": 0.7437104873519105}, {"class_code": "5183", "loss_ratio": 0.5207381870463249}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "8810", "loss_ratio": 1.044455946275772}, {"class_code": "5190", "loss_ratio": 0.7938373106585808}, {"class_code": "5506", "loss_ratio": 0.5389310801282446}, {"class_code": "8017", "loss_ratio": 0.4529201065057758}, {"class_code": "5183", "loss_ratio": 0.36209708876403257}, {"class_code": "8742", "loss_ratio": 0.16911400815540945}, {"class_code": "8820", "loss_ratio": 0.00818874967243504}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 55.8986367564513}, {"class_code": "8810", "pure_premium": 50.434807821313846}, {"class_code": "8820", "pure_premium": 47.326974642861}, {"class_code": "5190", "pure_premium": 45.19630613640151}, {"class_code": "5183", "pure_premium": 42.28105606745629}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for MA?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 1.0090293731156201}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5224.368318238994}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for FL in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 9083.342712355214}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "FL", "coverage_type": "Commercial Property", "frequency": 0.005662996360472919}, {"state": "FL", "coverage_type": "General Liability", "frequency": 0.004952392626736267}, {"state": "FL", "coverage_type": "Commercial Auto", "frequency": 0.004882603238195369}, {"state": "FL", "coverage_type": "Workers Compensation", "frequency": 0.0048681784090739266}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8820", "loss_ratio": 1.2775640085432782}, {"class_code": "5190", "loss_ratio": 1.263152029678575}, {"class_code": "8810", "loss_ratio": 0.3271444217835599}, {"class_code": "8742", "loss_ratio": 0.30206163351718585}, {"class_code": "5506", "loss_ratio": 0.25886893763193225}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average policy_count for class code 8820", "output": "SELECT AVG(policy_count) AS avg_policy_count\nFROM insurance_loss_data\nWHERE class_code = '8820'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_policy_count": 51.669887278582934}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for TN in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.841533081382035}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for AZ in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 49.458654201977424}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "NY", "frequency": 0.005842334326428065}, {"state": "MO", "frequency": 0.005574913687116429}, {"state": "WA", "frequency": 0.005461830756764978}, {"state": "MA", "frequency": 0.005426997837813372}, {"state": "WI", "frequency": 0.005367470953357319}, {"state": "PA", "frequency": 0.005311015721486814}, {"state": "TX", "frequency": 0.005291255604370849}, {"state": "IN", "frequency": 0.005280053891509957}, {"state": "VA", "frequency": 0.005228301799223278}, {"state": "MI", "frequency": 0.0052237081448899434}, {"state": "GA", "frequency": 0.005220320158889982}, {"state": "NC", "frequency": 0.005215493577484546}, {"state": "MD", "frequency": 0.005198288015618081}, {"state": "FL", "frequency": 0.005068004590479151}, {"state": "OH", "frequency": 0.004964951276502602}, {"state": "CA", "frequency": 0.004891473180615508}, {"state": "IL", "frequency": 0.004851712206081064}, {"state": "NJ", "frequency": 0.0048100572988756096}, {"state": "TN", "frequency": 0.00480230474776852}, {"state": "AZ", "frequency": 0.004763301586225157}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 51.24461964357669}, {"class_code": "8017", "pure_premium": 45.34352326087986}, {"class_code": "8742", "pure_premium": 43.795096659749305}, {"class_code": "8810", "pure_premium": 43.64242009455048}, {"class_code": "5506", "pure_premium": 41.014829375242456}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total written_premium for MO?", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE state = 'MO'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_written_premium": 56827695.2}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "pure_premium": 43.68001996264619}, {"state": "NY", "pure_premium": 42.66280636621263}, {"state": "IN", "pure_premium": 42.62845837490903}, {"state": "GA", "pure_premium": 42.44143813899001}, {"state": "MO", "pure_premium": 41.96906644950354}, {"state": "MI", "pure_premium": 41.65446451508064}, {"state": "OH", "pure_premium": 41.315925594731176}, {"state": "WA", "pure_premium": 41.14914457747659}, {"state": "VA", "pure_premium": 40.98296525858418}, {"state": "MD", "pure_premium": 40.75768258043177}, {"state": "NC", "pure_premium": 39.61037111605624}, {"state": "AZ", "pure_premium": 39.55486823823268}, {"state": "PA", "pure_premium": 39.48035385012789}, {"state": "MA", "pure_premium": 39.23052050225903}, {"state": "TX", "pure_premium": 39.21001978745931}, {"state": "TN", "pure_premium": 38.929288671908814}, {"state": "WI", "pure_premium": 38.78771784056159}, {"state": "IL", "pure_premium": 38.731168534768486}, {"state": "NJ", "pure_premium": 38.47699373391945}, {"state": "CA", "pure_premium": 37.676420942517574}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IL", "coverage_type": "Workers Compensation", "frequency": 0.00540555548697377}, {"state": "IL", "coverage_type": "General Liability", "frequency": 0.004787550378600992}, {"state": "IL", "coverage_type": "Commercial Property", "frequency": 0.0047853414234455575}, {"state": "IL", "coverage_type": "Commercial Auto", "frequency": 0.004596174482039275}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 55.8986367564513}, {"class_code": "8810", "pure_premium": 50.434807821313846}, {"class_code": "8820", "pure_premium": 47.326974642861}, {"class_code": "5190", "pure_premium": 45.19630613640151}, {"class_code": "5183", "pure_premium": 42.28105606745629}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 9015", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 1.0118409220191624}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "WI", "reserve_ratio": 0.5413736382644159}, {"state": "MO", "reserve_ratio": 0.5341641158452941}, {"state": "IL", "reserve_ratio": 0.5329817799541723}, {"state": "NC", "reserve_ratio": 0.5277701245861793}, {"state": "MA", "reserve_ratio": 0.5199079774546557}, {"state": "TX", "reserve_ratio": 0.5193077177541042}, {"state": "WA", "reserve_ratio": 0.5145507801393678}, {"state": "FL", "reserve_ratio": 0.5092773986933368}, {"state": "MD", "reserve_ratio": 0.5022521064463745}, {"state": "CA", "reserve_ratio": 0.49860490135540214}, {"state": "MI", "reserve_ratio": 0.49758912443507414}, {"state": "NY", "reserve_ratio": 0.4962413427184941}, {"state": "PA", "reserve_ratio": 0.4960151914205872}, {"state": "TN", "reserve_ratio": 0.4935634333246963}, {"state": "NJ", "reserve_ratio": 0.49286408077072313}, {"state": "OH", "reserve_ratio": 0.4858888917215781}, {"state": "IN", "reserve_ratio": 0.4799720227990084}, {"state": "VA", "reserve_ratio": 0.479617927301472}, {"state": "AZ", "reserve_ratio": 0.4783599588278123}, {"state": "GA", "reserve_ratio": 0.47279214450772306}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "AZ", "coverage_type": "Commercial Auto", "frequency": 0.005657541991444876}, {"state": "AZ", "coverage_type": "Commercial Property", "frequency": 0.005160274879188937}, {"state": "AZ", "coverage_type": "Workers Compensation", "frequency": 0.004201685061116369}, {"state": "AZ", "coverage_type": "General Liability", "frequency": 0.004103561718761466}, {"state": "TN", "coverage_type": "General Liability", "frequency": 0.005702595453595276}, {"state": "TN", "coverage_type": "Commercial Property", "frequency": 0.00499713846913048}, {"state": "TN", "coverage_type": "Workers Compensation", "frequency": 0.004349168053315909}, {"state": "TN", "coverage_type": "Commercial Auto", "frequency": 0.004255940076363725}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total earned_premium by state", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "AZ", "total_earned_premium": 69687084.75}, {"state": "WA", "total_earned_premium": 69013192.94}, {"state": "OH", "total_earned_premium": 67599579.32}, {"state": "NC", "total_earned_premium": 66357030.66}, {"state": "MA", "total_earned_premium": 66027298.06}, {"state": "TX", "total_earned_premium": 65514658.21}, {"state": "MD", "total_earned_premium": 65326804.07}, {"state": "NJ", "total_earned_premium": 64987777.52}, {"state": "PA", "total_earned_premium": 64346578.51}, {"state": "TN", "total_earned_premium": 64220126.32}, {"state": "FL", "total_earned_premium": 63072135.43}, {"state": "MO", "total_earned_premium": 62563783.0}, {"state": "VA", "total_earned_premium": 60930557.07}, {"state": "IL", "total_earned_premium": 60585591.79}, {"state": "WI", "total_earned_premium": 60435582.24}, {"state": "CA", "total_earned_premium": 59790204.47}, {"state": "GA", "total_earned_premium": 59414315.13}, {"state": "MI", "total_earned_premium": 58107180.9}, {"state": "IN", "total_earned_premium": 57418939.08}, {"state": "NY", "total_earned_premium": 55156873.91}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for PA?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'PA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.4960151914205872}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "OH", "coverage_type": "Workers Compensation", "frequency": 0.006833538373300537}, {"state": "OH", "coverage_type": "Commercial Property", "frequency": 0.004644885713748235}, {"state": "OH", "coverage_type": "General Liability", "frequency": 0.004619240140061332}, {"state": "OH", "coverage_type": "Commercial Auto", "frequency": 0.004316815239931538}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8742", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4807.560794054802}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "WI", "reserve_ratio": 0.5413736382644159}, {"state": "MO", "reserve_ratio": 0.5341641158452941}, {"state": "IL", "reserve_ratio": 0.5329817799541723}, {"state": "NC", "reserve_ratio": 0.5277701245861793}, {"state": "MA", "reserve_ratio": 0.5199079774546557}, {"state": "TX", "reserve_ratio": 0.5193077177541042}, {"state": "WA", "reserve_ratio": 0.5145507801393678}, {"state": "FL", "reserve_ratio": 0.5092773986933368}, {"state": "MD", "reserve_ratio": 0.5022521064463745}, {"state": "CA", "reserve_ratio": 0.49860490135540214}, {"state": "MI", "reserve_ratio": 0.49758912443507414}, {"state": "NY", "reserve_ratio": 0.4962413427184941}, {"state": "PA", "reserve_ratio": 0.4960151914205872}, {"state": "TN", "reserve_ratio": 0.4935634333246963}, {"state": "NJ", "reserve_ratio": 0.49286408077072313}, {"state": "OH", "reserve_ratio": 0.4858888917215781}, {"state": "IN", "reserve_ratio": 0.4799720227990084}, {"state": "VA", "reserve_ratio": 0.479617927301472}, {"state": "AZ", "reserve_ratio": 0.4783599588278123}, {"state": "GA", "reserve_ratio": 0.47279214450772306}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8820", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8820'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005245633185989471}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "TX", "coverage_type": "Commercial Property", "frequency": 0.005787023880955479}, {"state": "TX", "coverage_type": "Commercial Auto", "frequency": 0.00541866466540174}, {"state": "TX", "coverage_type": "Workers Compensation", "frequency": 0.004993892847175561}, {"state": "TX", "coverage_type": "General Liability", "frequency": 0.00494819152181612}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7648.501756570394}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for IN?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'IN'", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 52.308985942855685}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "FL", "coverage_type": "Commercial Property", "frequency": 0.005662996360472919}, {"state": "FL", "coverage_type": "General Liability", "frequency": 0.004952392626736267}, {"state": "FL", "coverage_type": "Commercial Auto", "frequency": 0.004882603238195369}, {"state": "FL", "coverage_type": "Workers Compensation", "frequency": 0.0048681784090739266}, {"state": "MD", "coverage_type": "Commercial Property", "frequency": 0.005651827092235917}, {"state": "MD", "coverage_type": "Workers Compensation", "frequency": 0.005394802870849437}, {"state": "MD", "coverage_type": "Commercial Auto", "frequency": 0.005104930991000689}, {"state": "MD", "coverage_type": "General Liability", "frequency": 0.004581416058435962}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 55.108204612233884}, {"class_code": "8810", "pure_premium": 47.05245733008544}, {"class_code": "8820", "pure_premium": 44.46522110062313}, {"class_code": "9015", "pure_premium": 44.39504352985302}, {"class_code": "5183", "pure_premium": 43.08660526106923}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 42.7697058949301}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for AZ?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.4783599588278123}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.33019288429234}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for GA?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005220320158889982}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 44.42204464474976}, {"class_code": "5506", "pure_premium": 43.60392917649229}, {"class_code": "5190", "pure_premium": 43.437078937146076}, {"class_code": "8820", "pure_premium": 41.1911920874482}, {"class_code": "8017", "pure_premium": 40.48657351694181}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4949.626187915278}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 49.67372498573775}, {"class_code": "9015", "pure_premium": 42.53804171971368}, {"class_code": "8810", "pure_premium": 38.53751093410779}, {"class_code": "8820", "pure_premium": 37.938143644216616}, {"class_code": "5506", "pure_premium": 37.78266611361865}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.5001317503656877}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 55.108204612233884}, {"class_code": "8810", "pure_premium": 47.05245733008544}, {"class_code": "8820", "pure_premium": 44.46522110062313}, {"class_code": "9015", "pure_premium": 44.39504352985302}, {"class_code": "5183", "pure_premium": 43.08660526106923}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5183", "loss_ratio": 7.329786678689225}, {"class_code": "8017", "loss_ratio": 2.244529385429612}, {"class_code": "5190", "loss_ratio": 0.6585742279084005}, {"class_code": "8820", "loss_ratio": 0.06957151673506773}, {"class_code": "8742", "loss_ratio": 0.0006969889326017302}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for PA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8521.04305640244}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2023?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 50.91267238046766}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 50.41652202564841}, {"class_code": "5190", "pure_premium": 48.97125789442456}, {"class_code": "8820", "pure_premium": 47.69389784008583}, {"class_code": "8742", "pure_premium": 43.375019262859325}, {"class_code": "9015", "pure_premium": 42.041863293961775}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'Midwest'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_premium": 4784.354558755225}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "AZ", "total_exposure_units": 1465160.22}, {"state": "TN", "total_exposure_units": 1383502.37}, {"state": "MA", "total_exposure_units": 1341072.95}, {"state": "PA", "total_exposure_units": 1329124.29}, {"state": "OH", "total_exposure_units": 1328109.71}, {"state": "NJ", "total_exposure_units": 1327842.81}, {"state": "IL", "total_exposure_units": 1289235.58}, {"state": "TX", "total_exposure_units": 1284950.21}, {"state": "MD", "total_exposure_units": 1255990.43}, {"state": "WA", "total_exposure_units": 1239144.95}, {"state": "VA", "total_exposure_units": 1216073.64}, {"state": "WI", "total_exposure_units": 1215097.4}, {"state": "NC", "total_exposure_units": 1214074.93}, {"state": "CA", "total_exposure_units": 1199025.28}, {"state": "FL", "total_exposure_units": 1179162.31}, {"state": "MI", "total_exposure_units": 1178090.32}, {"state": "GA", "total_exposure_units": 1156825.6}, {"state": "IN", "total_exposure_units": 1138435.35}, {"state": "MO", "total_exposure_units": 1121811.09}, {"state": "NY", "total_exposure_units": 979403.04}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 50.5089744354891}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8263554335781502}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IL", "paid_loss_ratio": 0.6656084286471571}, {"state": "WI", "paid_loss_ratio": 0.649880308491589}, {"state": "TX", "paid_loss_ratio": 0.6365016152009015}, {"state": "NJ", "paid_loss_ratio": 0.6334580352025554}, {"state": "TN", "paid_loss_ratio": 0.6252360868915836}, {"state": "GA", "paid_loss_ratio": 0.6228810480946463}, {"state": "MA", "paid_loss_ratio": 0.6140812956355586}, {"state": "VA", "paid_loss_ratio": 0.6088244274113939}, {"state": "MI", "paid_loss_ratio": 0.5982253384452179}, {"state": "IN", "paid_loss_ratio": 0.59453587121206}, {"state": "PA", "paid_loss_ratio": 0.5940486067034554}, {"state": "OH", "paid_loss_ratio": 0.5826399525883914}, {"state": "NY", "paid_loss_ratio": 0.5782333868674466}, {"state": "MO", "paid_loss_ratio": 0.574488033915724}, {"state": "FL", "paid_loss_ratio": 0.5721854822888148}, {"state": "MD", "paid_loss_ratio": 0.5629059676728803}, {"state": "NC", "paid_loss_ratio": 0.5610174722968836}, {"state": "CA", "paid_loss_ratio": 0.5525875028003563}, {"state": "AZ", "paid_loss_ratio": 0.5382113627590083}, {"state": "WA", "paid_loss_ratio": 0.5371712064131023}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 55.108204612233884}, {"class_code": "8810", "pure_premium": 47.05245733008544}, {"class_code": "8820", "pure_premium": 44.46522110062313}, {"class_code": "9015", "pure_premium": 44.39504352985302}, {"class_code": "5183", "pure_premium": 43.08660526106923}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5183", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.1892947588979174}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8810", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4850.365181986428}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "General Liability", "policy_count": 64479}, {"coverage_type": "Commercial Property", "policy_count": 63851}, {"coverage_type": "Workers Compensation", "policy_count": 63388}, {"coverage_type": "Commercial Auto", "policy_count": 61680}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "AZ", "coverage_type": "Commercial Auto", "frequency": 0.005657541991444876}, {"state": "AZ", "coverage_type": "Commercial Property", "frequency": 0.005160274879188937}, {"state": "AZ", "coverage_type": "Workers Compensation", "frequency": 0.004201685061116369}, {"state": "AZ", "coverage_type": "General Liability", "frequency": 0.004103561718761466}, {"state": "NC", "coverage_type": "Commercial Property", "frequency": 0.005690826185417609}, {"state": "NC", "coverage_type": "Workers Compensation", "frequency": 0.00540485044455505}, {"state": "NC", "coverage_type": "General Liability", "frequency": 0.004989717003489062}, {"state": "NC", "coverage_type": "Commercial Auto", "frequency": 0.004935282997740556}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8085.209905468296}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5081.1318969701715}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for GA?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 1.0276079461054288}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"class_code": "8742", "loss_ratio": 8.746679119331231}, {"class_code": "8810", "loss_ratio": 0.8248297701444774}, {"class_code": "8820", "loss_ratio": 0.5982080068583788}, {"class_code": "5183", "loss_ratio": 0.43063171907770137}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "MO", "expense_ratio": 0.21527399302303568}, {"state": "NY", "expense_ratio": 0.21306945111061146}, {"state": "MA", "expense_ratio": 0.2089888150648086}, {"state": "OH", "expense_ratio": 0.20788801640571763}, {"state": "WI", "expense_ratio": 0.20787958057401879}, {"state": "NC", "expense_ratio": 0.2072035574339776}, {"state": "MI", "expense_ratio": 0.20669136094724092}, {"state": "TX", "expense_ratio": 0.20370291149482553}, {"state": "MD", "expense_ratio": 0.19773495698407942}, {"state": "AZ", "expense_ratio": 0.19760114715871627}, {"state": "NJ", "expense_ratio": 0.19601920035269135}, {"state": "VA", "expense_ratio": 0.19521834405283348}, {"state": "FL", "expense_ratio": 0.19432434198199192}, {"state": "IL", "expense_ratio": 0.1943217197591877}, {"state": "PA", "expense_ratio": 0.19140360629270242}, {"state": "GA", "expense_ratio": 0.18950862999652568}, {"state": "WA", "expense_ratio": 0.18903383054657782}, {"state": "IN", "expense_ratio": 0.18823116000792414}, {"state": "TN", "expense_ratio": 0.18069328608022348}, {"state": "CA", "expense_ratio": 0.1775065722249085}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8017", "loss_ratio": 0.8186423809168404}, {"class_code": "8810", "loss_ratio": 0.8170132186239819}, {"class_code": "9015", "loss_ratio": 0.808349495370977}, {"class_code": "5190", "loss_ratio": 0.8030004927646215}, {"class_code": "5183", "loss_ratio": 0.793463638744717}, {"class_code": "8742", "loss_ratio": 0.7922562362105812}, {"class_code": "8820", "loss_ratio": 0.7873688351977517}, {"class_code": "5506", "loss_ratio": 0.744577786250857}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 51.24461964357669}, {"class_code": "8017", "pure_premium": 45.34352326087986}, {"class_code": "8742", "pure_premium": 43.795096659749305}, {"class_code": "8810", "pure_premium": 43.64242009455048}, {"class_code": "5506", "pure_premium": 41.014829375242456}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}, {"state": "WI", "coverage_type": "Commercial Property", "frequency": 0.005893619245835043}, {"state": "WI", "coverage_type": "Commercial Auto", "frequency": 0.005662830159835041}, {"state": "WI", "coverage_type": "Workers Compensation", "frequency": 0.005117575849296508}, {"state": "WI", "coverage_type": "General Liability", "frequency": 0.004776777591583218}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.33019288429234}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in VA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"industry": "Technology", "total_claims": 1321}, {"industry": "Manufacturing", "total_claims": 1253}, {"industry": "Construction", "total_claims": 1115}, {"industry": "Retail", "total_claims": 928}, {"industry": "Healthcare", "total_claims": 885}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 49.67372498573775}, {"class_code": "9015", "pure_premium": 42.53804171971368}, {"class_code": "8810", "pure_premium": 38.53751093410779}, {"class_code": "8820", "pure_premium": 37.938143644216616}, {"class_code": "5506", "pure_premium": 37.78266611361865}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for New York?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7575498625643559}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8166178755302055}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7562.075029335517}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in Virginia", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'VA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claim_count": 1226}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for WI in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 46.69540356861979}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8810 in MO?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8810' AND state = 'MO'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 46.871981426223996}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.55242101992495}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "5183", "loss_ratio": 2.311625312386264}, {"class_code": "5506", "loss_ratio": 0.9458404019232969}, {"class_code": "5190", "loss_ratio": 0.8384247767710227}, {"class_code": "8017", "loss_ratio": 0.7957310340515411}, {"class_code": "8820", "loss_ratio": 0.614388311034457}, {"class_code": "8810", "loss_ratio": 0.4677458244631362}, {"class_code": "8742", "loss_ratio": 0.25659799860906096}, {"class_code": "9015", "loss_ratio": 0.22438850653718606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 55.108204612233884}, {"class_code": "8810", "pure_premium": 47.05245733008544}, {"class_code": "8820", "pure_premium": 44.46522110062313}, {"class_code": "9015", "pure_premium": 44.39504352985302}, {"class_code": "5183", "pure_premium": 43.08660526106923}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NC in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 56.19601201839636}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 50.41652202564841}, {"class_code": "5190", "pure_premium": 48.97125789442456}, {"class_code": "8820", "pure_premium": 47.69389784008583}, {"class_code": "8742", "pure_premium": 43.375019262859325}, {"class_code": "9015", "pure_premium": 42.041863293961775}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8064.9118502343845}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for OH?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'OH'", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8321.516827418865}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "8742", "loss_ratio": 2.6627523892301603}, {"class_code": "8820", "loss_ratio": 1.521382973443877}, {"class_code": "5183", "loss_ratio": 0.7024829316780532}, {"class_code": "5506", "loss_ratio": 0.7021133686005503}, {"class_code": "8017", "loss_ratio": 0.5294243870701992}, {"class_code": "8810", "loss_ratio": 0.4523669599015892}, {"class_code": "9015", "loss_ratio": 0.086141590154217}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7922562362105812}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "8820", "loss_ratio": 0.8835472263508213}, {"class_code": "5190", "loss_ratio": 0.8771681460330214}, {"class_code": "5506", "loss_ratio": 0.7812141384268415}, {"class_code": "8017", "loss_ratio": 0.5638106946216981}, {"class_code": "5183", "loss_ratio": 0.5591483051751721}, {"class_code": "9015", "loss_ratio": 0.03628311015962234}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.793463638744717}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "AZ", "coverage_type": "Commercial Auto", "frequency": 0.005657541991444876}, {"state": "AZ", "coverage_type": "Commercial Property", "frequency": 0.005160274879188937}, {"state": "AZ", "coverage_type": "Workers Compensation", "frequency": 0.004201685061116369}, {"state": "AZ", "coverage_type": "General Liability", "frequency": 0.004103561718761466}, {"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 51.24461964357669}, {"class_code": "8017", "pure_premium": 45.34352326087986}, {"class_code": "8742", "pure_premium": 43.795096659749305}, {"class_code": "8810", "pure_premium": 43.64242009455048}, {"class_code": "5506", "pure_premium": 41.014829375242456}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "8017", "loss_ratio": 1.062065615716929}, {"class_code": "9015", "loss_ratio": 0.5282005610584701}, {"class_code": "5190", "loss_ratio": 0.4342093821683475}, {"class_code": "8820", "loss_ratio": 0.409076829395164}, {"class_code": "8742", "loss_ratio": 0.2528776017706185}, {"class_code": "5506", "loss_ratio": 0.06602687755252704}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for NY?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.21306945111061146}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "NY", "frequency": 0.005842334326428065}, {"state": "MO", "frequency": 0.005574913687116429}, {"state": "WA", "frequency": 0.005461830756764978}, {"state": "MA", "frequency": 0.005426997837813372}, {"state": "WI", "frequency": 0.005367470953357319}, {"state": "PA", "frequency": 0.005311015721486814}, {"state": "TX", "frequency": 0.005291255604370849}, {"state": "IN", "frequency": 0.005280053891509957}, {"state": "VA", "frequency": 0.005228301799223278}, {"state": "MI", "frequency": 0.0052237081448899434}, {"state": "GA", "frequency": 0.005220320158889982}, {"state": "NC", "frequency": 0.005215493577484546}, {"state": "MD", "frequency": 0.005198288015618081}, {"state": "FL", "frequency": 0.005068004590479151}, {"state": "OH", "frequency": 0.004964951276502602}, {"state": "CA", "frequency": 0.004891473180615508}, {"state": "IL", "frequency": 0.004851712206081064}, {"state": "NJ", "frequency": 0.0048100572988756096}, {"state": "TN", "frequency": 0.00480230474776852}, {"state": "AZ", "frequency": 0.004763301586225157}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8810", "pure_premium": 46.6503331702338}, {"class_code": "5506", "pure_premium": 44.484729929522004}, {"class_code": "8742", "pure_premium": 43.44431185542055}, {"class_code": "5183", "pure_premium": 40.931750337338926}, {"class_code": "8820", "pure_premium": 40.68693068322849}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8810", "pure_premium": 46.6503331702338}, {"class_code": "5506", "pure_premium": 44.484729929522004}, {"class_code": "8742", "pure_premium": 43.44431185542055}, {"class_code": "5183", "pure_premium": 40.931750337338926}, {"class_code": "8820", "pure_premium": 40.68693068322849}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5506'", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7674.584493228063}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 49.67372498573775}, {"class_code": "9015", "pure_premium": 42.53804171971368}, {"class_code": "8810", "pure_premium": 38.53751093410779}, {"class_code": "8820", "pure_premium": 37.938143644216616}, {"class_code": "5506", "pure_premium": 37.78266611361865}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8017", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5080.156635620967}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 9015", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.5130964872790715}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for IL?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.6656084286471571}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.5519841252784213}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TN", "combined_ratio": 1.042555461606884}, {"state": "IN", "combined_ratio": 1.040405579015794}, {"state": "MI", "combined_ratio": 1.0395517437673527}, {"state": "IL", "combined_ratio": 1.0336624401898906}, {"state": "GA", "combined_ratio": 1.0276079461054288}, {"state": "AZ", "combined_ratio": 1.0247814893705967}, {"state": "OH", "combined_ratio": 1.0228017232578246}, {"state": "PA", "combined_ratio": 1.0157189355428249}, {"state": "FL", "combined_ratio": 1.0090584867010584}, {"state": "MA", "combined_ratio": 1.0090293731156201}, {"state": "VA", "combined_ratio": 1.0045414178584007}, {"state": "WI", "combined_ratio": 0.9806038774418532}, {"state": "NJ", "combined_ratio": 0.9797951796459586}, {"state": "MD", "combined_ratio": 0.9693476125381194}, {"state": "TX", "combined_ratio": 0.9692099622418223}, {"state": "NY", "combined_ratio": 0.963815907455949}, {"state": "MO", "combined_ratio": 0.9480706919528827}, {"state": "CA", "combined_ratio": 0.9312948882444255}, {"state": "WA", "combined_ratio": 0.925992064380495}, {"state": "NC", "combined_ratio": 0.9220555104929103}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"class_code": "8742", "loss_ratio": 8.746679119331231}, {"class_code": "8810", "loss_ratio": 0.8248297701444774}, {"class_code": "8820", "loss_ratio": 0.5982080068583788}, {"class_code": "5183", "loss_ratio": 0.43063171907770137}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TX", "loss_ratio": 0.9527072630226262}, {"state": "MA", "loss_ratio": 0.9377115219355888}, {"state": "IN", "loss_ratio": 0.8628327270596653}, {"state": "TN", "loss_ratio": 0.8518487027143875}, {"state": "WA", "loss_ratio": 0.8207302664862852}, {"state": "FL", "loss_ratio": 0.8201673756085506}, {"state": "OH", "loss_ratio": 0.8028637230099516}, {"state": "NJ", "loss_ratio": 0.799628212502186}, {"state": "IL", "loss_ratio": 0.7884231106438916}, {"state": "PA", "loss_ratio": 0.7875883350006327}, {"state": "AZ", "loss_ratio": 0.7832643840745365}, {"state": "WI", "loss_ratio": 0.7782344942184595}, {"state": "MD", "loss_ratio": 0.7469887562444165}, {"state": "MO", "loss_ratio": 0.7389215395562007}, {"state": "NY", "loss_ratio": 0.7153180003622782}, {"state": "VA", "loss_ratio": 0.7079681041879607}, {"state": "GA", "loss_ratio": 0.7045381193082592}, {"state": "MI", "loss_ratio": 0.6767110418929172}, {"state": "CA", "loss_ratio": 0.6558155198648719}, {"state": "NC", "loss_ratio": 0.5630123586721031}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "WI", "reserve_ratio": 0.5413736382644159}, {"state": "MO", "reserve_ratio": 0.5341641158452941}, {"state": "IL", "reserve_ratio": 0.5329817799541723}, {"state": "NC", "reserve_ratio": 0.5277701245861793}, {"state": "MA", "reserve_ratio": 0.5199079774546557}, {"state": "TX", "reserve_ratio": 0.5193077177541042}, {"state": "WA", "reserve_ratio": 0.5145507801393678}, {"state": "FL", "reserve_ratio": 0.5092773986933368}, {"state": "MD", "reserve_ratio": 0.5022521064463745}, {"state": "CA", "reserve_ratio": 0.49860490135540214}, {"state": "MI", "reserve_ratio": 0.49758912443507414}, {"state": "NY", "reserve_ratio": 0.4962413427184941}, {"state": "PA", "reserve_ratio": 0.4960151914205872}, {"state": "TN", "reserve_ratio": 0.4935634333246963}, {"state": "NJ", "reserve_ratio": 0.49286408077072313}, {"state": "OH", "reserve_ratio": 0.4858888917215781}, {"state": "IN", "reserve_ratio": 0.4799720227990084}, {"state": "VA", "reserve_ratio": 0.479617927301472}, {"state": "AZ", "reserve_ratio": 0.4783599588278123}, {"state": "GA", "reserve_ratio": 0.47279214450772306}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for AZ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.831635010388349}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IL", "coverage_type": "Workers Compensation", "frequency": 0.00540555548697377}, {"state": "IL", "coverage_type": "General Liability", "frequency": 0.004787550378600992}, {"state": "IL", "coverage_type": "Commercial Property", "frequency": 0.0047853414234455575}, {"state": "IL", "coverage_type": "Commercial Auto", "frequency": 0.004596174482039275}, {"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "NC", "coverage_type": "Commercial Property", "frequency": 0.005690826185417609}, {"state": "NC", "coverage_type": "Workers Compensation", "frequency": 0.00540485044455505}, {"state": "NC", "coverage_type": "General Liability", "frequency": 0.004989717003489062}, {"state": "NC", "coverage_type": "Commercial Auto", "frequency": 0.004935282997740556}, {"state": "TX", "coverage_type": "Commercial Property", "frequency": 0.005787023880955479}, {"state": "TX", "coverage_type": "Commercial Auto", "frequency": 0.00541866466540174}, {"state": "TX", "coverage_type": "Workers Compensation", "frequency": 0.004993892847175561}, {"state": "TX", "coverage_type": "General Liability", "frequency": 0.00494819152181612}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average policy_count for class code 8742", "output": "SELECT AVG(policy_count) AS avg_policy_count\nFROM insurance_loss_data\nWHERE class_code = '8742'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_policy_count": 51.74634146341464}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 49.67372498573775}, {"class_code": "9015", "pure_premium": 42.53804171971368}, {"class_code": "8810", "pure_premium": 38.53751093410779}, {"class_code": "8820", "pure_premium": 37.938143644216616}, {"class_code": "5506", "pure_premium": 37.78266611361865}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "pure_premium": 43.68001996264619}, {"state": "NY", "pure_premium": 42.66280636621263}, {"state": "IN", "pure_premium": 42.62845837490903}, {"state": "GA", "pure_premium": 42.44143813899001}, {"state": "MO", "pure_premium": 41.96906644950354}, {"state": "MI", "pure_premium": 41.65446451508064}, {"state": "OH", "pure_premium": 41.315925594731176}, {"state": "WA", "pure_premium": 41.14914457747659}, {"state": "VA", "pure_premium": 40.98296525858418}, {"state": "MD", "pure_premium": 40.75768258043177}, {"state": "NC", "pure_premium": 39.61037111605624}, {"state": "AZ", "pure_premium": 39.55486823823268}, {"state": "PA", "pure_premium": 39.48035385012789}, {"state": "MA", "pure_premium": 39.23052050225903}, {"state": "TX", "pure_premium": 39.21001978745931}, {"state": "TN", "pure_premium": 38.929288671908814}, {"state": "WI", "pure_premium": 38.78771784056159}, {"state": "IL", "pure_premium": 38.731168534768486}, {"state": "NJ", "pure_premium": 38.47699373391945}, {"state": "CA", "pure_premium": 37.676420942517574}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for FL in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 41.50314127786389}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for MO in 2023", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005060528824496573}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8742", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8742'", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 49.651176408578884}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 51.028235461912764}, {"class_code": "8820", "pure_premium": 47.82638726596499}, {"class_code": "5183", "pure_premium": 40.10071560336792}, {"class_code": "8742", "pure_premium": 40.06677837177819}, {"class_code": "8810", "pure_premium": 38.38427050910045}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.808349495370977}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "NY", "frequency": 0.005842334326428065}, {"state": "MO", "frequency": 0.005574913687116429}, {"state": "WA", "frequency": 0.005461830756764978}, {"state": "MA", "frequency": 0.005426997837813372}, {"state": "WI", "frequency": 0.005367470953357319}, {"state": "PA", "frequency": 0.005311015721486814}, {"state": "TX", "frequency": 0.005291255604370849}, {"state": "IN", "frequency": 0.005280053891509957}, {"state": "VA", "frequency": 0.005228301799223278}, {"state": "MI", "frequency": 0.0052237081448899434}, {"state": "GA", "frequency": 0.005220320158889982}, {"state": "NC", "frequency": 0.005215493577484546}, {"state": "MD", "frequency": 0.005198288015618081}, {"state": "FL", "frequency": 0.005068004590479151}, {"state": "OH", "frequency": 0.004964951276502602}, {"state": "CA", "frequency": 0.004891473180615508}, {"state": "IL", "frequency": 0.004851712206081064}, {"state": "NJ", "frequency": 0.0048100572988756096}, {"state": "TN", "frequency": 0.00480230474776852}, {"state": "AZ", "frequency": 0.004763301586225157}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8820", "loss_ratio": 1.1795454393673763}, {"class_code": "5183", "loss_ratio": 1.0863945892931481}, {"class_code": "8017", "loss_ratio": 0.8653159660087573}, {"class_code": "8742", "loss_ratio": 0.7853658606226803}, {"class_code": "9015", "loss_ratio": 0.6498998217829183}, {"class_code": "5190", "loss_ratio": 0.5266719019343532}, {"class_code": "5506", "loss_ratio": 0.44804927740391054}, {"class_code": "8810", "loss_ratio": 0.386838968873602}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5190 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND region = 'West'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_premium": 4784.1884635790875}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for North Carolina?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NC'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2021?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.4918653679287034}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.793463638744717}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IL", "paid_loss_ratio": 0.6656084286471571}, {"state": "WI", "paid_loss_ratio": 0.649880308491589}, {"state": "TX", "paid_loss_ratio": 0.6365016152009015}, {"state": "NJ", "paid_loss_ratio": 0.6334580352025554}, {"state": "TN", "paid_loss_ratio": 0.6252360868915836}, {"state": "GA", "paid_loss_ratio": 0.6228810480946463}, {"state": "MA", "paid_loss_ratio": 0.6140812956355586}, {"state": "VA", "paid_loss_ratio": 0.6088244274113939}, {"state": "MI", "paid_loss_ratio": 0.5982253384452179}, {"state": "IN", "paid_loss_ratio": 0.59453587121206}, {"state": "PA", "paid_loss_ratio": 0.5940486067034554}, {"state": "OH", "paid_loss_ratio": 0.5826399525883914}, {"state": "NY", "paid_loss_ratio": 0.5782333868674466}, {"state": "MO", "paid_loss_ratio": 0.574488033915724}, {"state": "FL", "paid_loss_ratio": 0.5721854822888148}, {"state": "MD", "paid_loss_ratio": 0.5629059676728803}, {"state": "NC", "paid_loss_ratio": 0.5610174722968836}, {"state": "CA", "paid_loss_ratio": 0.5525875028003563}, {"state": "AZ", "paid_loss_ratio": 0.5382113627590083}, {"state": "WA", "paid_loss_ratio": 0.5371712064131023}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8810 in NJ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8810' AND state = 'NJ'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 46.429780357200045}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "MD", "coverage_type": "Commercial Property", "frequency": 0.005651827092235917}, {"state": "MD", "coverage_type": "Workers Compensation", "frequency": 0.005394802870849437}, {"state": "MD", "coverage_type": "Commercial Auto", "frequency": 0.005104930991000689}, {"state": "MD", "coverage_type": "General Liability", "frequency": 0.004581416058435962}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for MD in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8317440722533425}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8030004927646215}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 39.16354391739986}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "5506", "loss_ratio": 1.506967405169131}, {"class_code": "8017", "loss_ratio": 1.1772455351239546}, {"class_code": "8820", "loss_ratio": 0.9728000361829842}, {"class_code": "8742", "loss_ratio": 0.7627020575466571}, {"class_code": "8810", "loss_ratio": 0.7437104873519105}, {"class_code": "5183", "loss_ratio": 0.5207381870463249}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8074683637449888}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.55242101992495}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for AZ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'AZ'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5270.510482822656}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 44.42204464474976}, {"class_code": "5506", "pure_premium": 43.60392917649229}, {"class_code": "5190", "pure_premium": 43.437078937146076}, {"class_code": "8820", "pure_premium": 41.1911920874482}, {"class_code": "8017", "pure_premium": 40.48657351694181}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 55.108204612233884}, {"class_code": "8810", "pure_premium": 47.05245733008544}, {"class_code": "8820", "pure_premium": 44.46522110062313}, {"class_code": "9015", "pure_premium": 44.39504352985302}, {"class_code": "5183", "pure_premium": 43.08660526106923}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8742", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 0.9879768927965353}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8810", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8810'", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 48.74454139578204}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for NC in 2019", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.006086899385614373}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "CA", "loss_ratio": 0.9683335985067021}, {"state": "IL", "loss_ratio": 0.9298506191879081}, {"state": "GA", "loss_ratio": 0.9296919447230777}, {"state": "MI", "loss_ratio": 0.9251202340922515}, {"state": "MO", "loss_ratio": 0.8901141038311196}, {"state": "NY", "loss_ratio": 0.8880840135453197}, {"state": "TN", "loss_ratio": 0.8863192304876208}, {"state": "MD", "loss_ratio": 0.8633252774686468}, {"state": "PA", "loss_ratio": 0.8600276950954684}, {"state": "IN", "loss_ratio": 0.8442810394365661}, {"state": "NC", "loss_ratio": 0.8274711262610789}, {"state": "NJ", "loss_ratio": 0.824047940023472}, {"state": "FL", "loss_ratio": 0.8037234735233876}, {"state": "TX", "loss_ratio": 0.8015749087938548}, {"state": "VA", "loss_ratio": 0.8002005336589315}, {"state": "OH", "loss_ratio": 0.7801738224237221}, {"state": "AZ", "loss_ratio": 0.7738973010372888}, {"state": "MA", "loss_ratio": 0.7380809431912718}, {"state": "WI", "loss_ratio": 0.69588506963754}, {"state": "WA", "loss_ratio": 0.67705912225188}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "NY", "coverage_type": "Workers Compensation", "frequency": 0.0060797159640319474}, {"state": "NY", "coverage_type": "Commercial Auto", "frequency": 0.005893728231739281}, {"state": "NY", "coverage_type": "General Liability", "frequency": 0.005891627810555211}, {"state": "NY", "coverage_type": "Commercial Property", "frequency": 0.005466408228316761}, {"state": "WI", "coverage_type": "Commercial Property", "frequency": 0.005893619245835043}, {"state": "WI", "coverage_type": "Commercial Auto", "frequency": 0.005662830159835041}, {"state": "WI", "coverage_type": "Workers Compensation", "frequency": 0.005117575849296508}, {"state": "WI", "coverage_type": "General Liability", "frequency": 0.004776777591583218}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 46.16354553419078}, {"class_code": "8820", "pure_premium": 44.083003662339976}, {"class_code": "8810", "pure_premium": 42.361402879599105}, {"class_code": "5183", "pure_premium": 39.96222914394711}, {"class_code": "5506", "pure_premium": 37.08611594514066}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "General Liability", "policy_count": 64479}, {"coverage_type": "Commercial Property", "policy_count": 63851}, {"coverage_type": "Workers Compensation", "policy_count": 63388}, {"coverage_type": "Commercial Auto", "policy_count": 61680}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "General Liability", "policy_count": 64479}, {"coverage_type": "Commercial Property", "policy_count": 63851}, {"coverage_type": "Workers Compensation", "policy_count": 63388}, {"coverage_type": "Commercial Auto", "policy_count": 61680}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"class_code": "8742", "loss_ratio": 8.746679119331231}, {"class_code": "8810", "loss_ratio": 0.8248297701444774}, {"class_code": "8820", "loss_ratio": 0.5982080068583788}, {"class_code": "5183", "loss_ratio": 0.43063171907770137}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}, {"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total policy_count for MI?", "output": "SELECT SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nWHERE state = 'MI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_policy_count": 11982}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in Maryland?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'MD'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 44.908799380101236}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for PA in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7543.359603448276}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TN", "combined_ratio": 1.042555461606884}, {"state": "IN", "combined_ratio": 1.040405579015794}, {"state": "MI", "combined_ratio": 1.0395517437673527}, {"state": "IL", "combined_ratio": 1.0336624401898906}, {"state": "GA", "combined_ratio": 1.0276079461054288}, {"state": "AZ", "combined_ratio": 1.0247814893705967}, {"state": "OH", "combined_ratio": 1.0228017232578246}, {"state": "PA", "combined_ratio": 1.0157189355428249}, {"state": "FL", "combined_ratio": 1.0090584867010584}, {"state": "MA", "combined_ratio": 1.0090293731156201}, {"state": "VA", "combined_ratio": 1.0045414178584007}, {"state": "WI", "combined_ratio": 0.9806038774418532}, {"state": "NJ", "combined_ratio": 0.9797951796459586}, {"state": "MD", "combined_ratio": 0.9693476125381194}, {"state": "TX", "combined_ratio": 0.9692099622418223}, {"state": "NY", "combined_ratio": 0.963815907455949}, {"state": "MO", "combined_ratio": 0.9480706919528827}, {"state": "CA", "combined_ratio": 0.9312948882444255}, {"state": "WA", "combined_ratio": 0.925992064380495}, {"state": "NC", "combined_ratio": 0.9220555104929103}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MA", "coverage_type": "General Liability", "frequency": 0.005757060987778602}, {"state": "MA", "coverage_type": "Workers Compensation", "frequency": 0.005476079556605489}, {"state": "MA", "coverage_type": "Commercial Property", "frequency": 0.00541962011636064}, {"state": "MA", "coverage_type": "Commercial Auto", "frequency": 0.005015564207657125}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "5183", "loss_ratio": 2.3345250075910897}, {"class_code": "8742", "loss_ratio": 0.6862396945389913}, {"class_code": "5190", "loss_ratio": 0.5393533617529847}, {"class_code": "8810", "loss_ratio": 0.5256842488954868}, {"class_code": "9015", "loss_ratio": 0.40013951622430727}, {"class_code": "5506", "loss_ratio": 0.3904238361850569}, {"class_code": "8820", "loss_ratio": 0.3565411839775999}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for TX in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 38.53397478953107}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IL", "paid_loss_ratio": 0.6656084286471571}, {"state": "WI", "paid_loss_ratio": 0.649880308491589}, {"state": "TX", "paid_loss_ratio": 0.6365016152009015}, {"state": "NJ", "paid_loss_ratio": 0.6334580352025554}, {"state": "TN", "paid_loss_ratio": 0.6252360868915836}, {"state": "GA", "paid_loss_ratio": 0.6228810480946463}, {"state": "MA", "paid_loss_ratio": 0.6140812956355586}, {"state": "VA", "paid_loss_ratio": 0.6088244274113939}, {"state": "MI", "paid_loss_ratio": 0.5982253384452179}, {"state": "IN", "paid_loss_ratio": 0.59453587121206}, {"state": "PA", "paid_loss_ratio": 0.5940486067034554}, {"state": "OH", "paid_loss_ratio": 0.5826399525883914}, {"state": "NY", "paid_loss_ratio": 0.5782333868674466}, {"state": "MO", "paid_loss_ratio": 0.574488033915724}, {"state": "FL", "paid_loss_ratio": 0.5721854822888148}, {"state": "MD", "paid_loss_ratio": 0.5629059676728803}, {"state": "NC", "paid_loss_ratio": 0.5610174722968836}, {"state": "CA", "paid_loss_ratio": 0.5525875028003563}, {"state": "AZ", "paid_loss_ratio": 0.5382113627590083}, {"state": "WA", "paid_loss_ratio": 0.5371712064131023}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "8017", "loss_ratio": 1.2203056186986803}, {"class_code": "8820", "loss_ratio": 0.8413886302715495}, {"class_code": "5506", "loss_ratio": 0.8248288677231375}, {"class_code": "8810", "loss_ratio": 0.5175750850624518}, {"class_code": "5183", "loss_ratio": 0.1501372690779623}, {"class_code": "8742", "loss_ratio": 0.07093086711691814}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8017", "loss_ratio": 0.8186423809168404}, {"class_code": "8810", "loss_ratio": 0.8170132186239819}, {"class_code": "9015", "loss_ratio": 0.808349495370977}, {"class_code": "5190", "loss_ratio": 0.8030004927646215}, {"class_code": "5183", "loss_ratio": 0.793463638744717}, {"class_code": "8742", "loss_ratio": 0.7922562362105812}, {"class_code": "8820", "loss_ratio": 0.7873688351977517}, {"class_code": "5506", "loss_ratio": 0.744577786250857}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss trend by year for AZ", "output": "SELECT policy_year, SUM(incurred_loss) AS incurred_loss\nFROM insurance_loss_data\nWHERE state = 'AZ'\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "incurred_loss": 10603291.85}, {"policy_year": 2020, "incurred_loss": 11053330.58}, {"policy_year": 2021, "incurred_loss": 11954844.37}, {"policy_year": 2022, "incurred_loss": 13647846.95}, {"policy_year": 2023, "incurred_loss": 10694905.7}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 52.406249783828144}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "TN", "coverage_type": "General Liability", "frequency": 0.005702595453595276}, {"state": "TN", "coverage_type": "Commercial Property", "frequency": 0.00499713846913048}, {"state": "TN", "coverage_type": "Workers Compensation", "frequency": 0.004349168053315909}, {"state": "TN", "coverage_type": "Commercial Auto", "frequency": 0.004255940076363725}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2019 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "AZ", "loss_ratio": 0.955139314102701}, {"state": "IN", "loss_ratio": 0.9312980441023642}, {"state": "IL", "loss_ratio": 0.9091509168149569}, {"state": "FL", "loss_ratio": 0.8907532693567222}, {"state": "TN", "loss_ratio": 0.841533081382035}, {"state": "MI", "loss_ratio": 0.8363557713246981}, {"state": "OH", "loss_ratio": 0.8333798806083008}, {"state": "PA", "loss_ratio": 0.7825173948909989}, {"state": "WI", "loss_ratio": 0.7818250572704742}, {"state": "MO", "loss_ratio": 0.7697362914429737}, {"state": "NC", "loss_ratio": 0.7653178505298311}, {"state": "TX", "loss_ratio": 0.7612067371289073}, {"state": "VA", "loss_ratio": 0.756744592440215}, {"state": "CA", "loss_ratio": 0.7531954506666667}, {"state": "MA", "loss_ratio": 0.7153354396962011}, {"state": "MD", "loss_ratio": 0.7120204605056155}, {"state": "NJ", "loss_ratio": 0.6786371439352757}, {"state": "WA", "loss_ratio": 0.6777987897367871}, {"state": "GA", "loss_ratio": 0.6731627510015141}, {"state": "NY", "loss_ratio": 0.620906371488627}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for TN in 2019", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.5739813111740453}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total incurred_loss by state", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "AZ", "total_incurred_loss": 57954219.45}, {"state": "OH", "total_incurred_loss": 54872081.96}, {"state": "TN", "total_incurred_loss": 53858763.14}, {"state": "MA", "total_incurred_loss": 52610989.86}, {"state": "PA", "total_incurred_loss": 52474297.28}, {"state": "FL", "total_incurred_loss": 51505833.24}, {"state": "MD", "total_incurred_loss": 51191259.27}, {"state": "NJ", "total_incurred_loss": 51091399.48}, {"state": "WA", "total_incurred_loss": 50989754.7}, {"state": "TX", "total_incurred_loss": 50382923.16}, {"state": "IL", "total_incurred_loss": 49933600.53}, {"state": "VA", "total_incurred_loss": 49838303.74}, {"state": "GA", "total_incurred_loss": 49097342.14}, {"state": "MI", "total_incurred_loss": 49072721.43}, {"state": "IN", "total_incurred_loss": 48529743.93}, {"state": "NC", "total_incurred_loss": 48089958.54}, {"state": "WI", "total_incurred_loss": 47130855.1}, {"state": "MO", "total_incurred_loss": 47081364.18}, {"state": "CA", "total_incurred_loss": 45174981.17}, {"state": "NY", "total_incurred_loss": 41784082.25}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 39.33289260108213}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for WI?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'WI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4516.574014858381}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 39.16354391739986}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for NJ in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 9284.751296803654}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Missouri", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"industry": "Construction", "total_claims": 1403}, {"industry": "Manufacturing", "total_claims": 1249}, {"industry": "Healthcare", "total_claims": 1025}, {"industry": "Retail", "total_claims": 920}, {"industry": "Hospitality", "total_claims": 897}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for TX?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.20370291149482553}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.20444266398452438}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in WA for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1507}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8820", "loss_ratio": 4.632928994548826}, {"class_code": "5183", "loss_ratio": 1.0818409395460151}, {"class_code": "8017", "loss_ratio": 1.0736726040272806}, {"class_code": "9015", "loss_ratio": 0.5185012623899715}, {"class_code": "8742", "loss_ratio": 0.47605459099465663}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5183", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 0.9890049591916856}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "GA", "coverage_type": "Workers Compensation", "frequency": 0.005735867259770458}, {"state": "GA", "coverage_type": "General Liability", "frequency": 0.005523248190918561}, {"state": "GA", "coverage_type": "Commercial Property", "frequency": 0.005255879098857317}, {"state": "GA", "coverage_type": "Commercial Auto", "frequency": 0.004440688289132688}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8017", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.6129901177545083}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5190", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 0.9912798527570394}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for AZ in 2020", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.6613968893020354}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "8810", "loss_ratio": 2.3251066591734806}, {"class_code": "8820", "loss_ratio": 0.9716011092790918}, {"class_code": "5506", "loss_ratio": 0.7869069533483071}, {"class_code": "8742", "loss_ratio": 0.5573922864168394}, {"class_code": "5183", "loss_ratio": 0.5396557723691808}, {"class_code": "8017", "loss_ratio": 0.3700486535873663}, {"class_code": "5190", "loss_ratio": 0.2987922346851382}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in MA for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1827}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7798527515269952}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IL", "coverage_type": "Workers Compensation", "frequency": 0.00540555548697377}, {"state": "IL", "coverage_type": "General Liability", "frequency": 0.004787550378600992}, {"state": "IL", "coverage_type": "Commercial Property", "frequency": 0.0047853414234455575}, {"state": "IL", "coverage_type": "Commercial Auto", "frequency": 0.004596174482039275}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5041.206206845238}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for MD?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'MD'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_incurred_loss": 51191259.27}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7552.168598523237}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for TX?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'TX'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005291255604370849}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "loss_ratio": 1.1646139057710367}, {"class_code": "8017", "loss_ratio": 0.8913370728828188}, {"class_code": "9015", "loss_ratio": 0.7171676929680761}, {"class_code": "5506", "loss_ratio": 0.2428292019424806}, {"class_code": "8820", "loss_ratio": 0.13456901420625275}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 52.63911229909947}, {"class_code": "8742", "pure_premium": 51.86288890088155}, {"class_code": "8017", "pure_premium": 46.868980179357514}, {"class_code": "9015", "pure_premium": 34.38135928559215}, {"class_code": "8810", "pure_premium": 33.86397946076651}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in IL for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1215}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8820", "pure_premium": 46.78005886503411}, {"class_code": "5506", "pure_premium": 43.68825442086105}, {"class_code": "8810", "pure_premium": 37.684764668798614}, {"class_code": "9015", "pure_premium": 37.06410294297614}, {"class_code": "8017", "pure_premium": 35.174899049762104}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "loss_ratio": 1.0237079753445122}, {"class_code": "9015", "loss_ratio": 0.5804416883909257}, {"class_code": "5506", "loss_ratio": 0.5393544382083022}, {"class_code": "5190", "loss_ratio": 0.5345494030578488}, {"class_code": "8820", "loss_ratio": 0.2562488102671649}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for TX in 2020", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.611338276980706}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2021?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005412690489399625}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "pure_premium": 43.68001996264619}, {"state": "NY", "pure_premium": 42.66280636621263}, {"state": "IN", "pure_premium": 42.62845837490903}, {"state": "GA", "pure_premium": 42.44143813899001}, {"state": "MO", "pure_premium": 41.96906644950354}, {"state": "MI", "pure_premium": 41.65446451508064}, {"state": "OH", "pure_premium": 41.315925594731176}, {"state": "WA", "pure_premium": 41.14914457747659}, {"state": "VA", "pure_premium": 40.98296525858418}, {"state": "MD", "pure_premium": 40.75768258043177}, {"state": "NC", "pure_premium": 39.61037111605624}, {"state": "AZ", "pure_premium": 39.55486823823268}, {"state": "PA", "pure_premium": 39.48035385012789}, {"state": "MA", "pure_premium": 39.23052050225903}, {"state": "TX", "pure_premium": 39.21001978745931}, {"state": "TN", "pure_premium": 38.929288671908814}, {"state": "WI", "pure_premium": 38.78771784056159}, {"state": "IL", "pure_premium": 38.731168534768486}, {"state": "NJ", "pure_premium": 38.47699373391945}, {"state": "CA", "pure_premium": 37.676420942517574}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for PA in 2023", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.6143568717419263}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for MA?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005426997837813372}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units for Workers Compensation in Pennsylvania", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'PA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_exposure_units": 356062.94}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "MO", "expense_ratio": 0.21527399302303568}, {"state": "NY", "expense_ratio": 0.21306945111061146}, {"state": "MA", "expense_ratio": 0.2089888150648086}, {"state": "OH", "expense_ratio": 0.20788801640571763}, {"state": "WI", "expense_ratio": 0.20787958057401879}, {"state": "NC", "expense_ratio": 0.2072035574339776}, {"state": "MI", "expense_ratio": 0.20669136094724092}, {"state": "TX", "expense_ratio": 0.20370291149482553}, {"state": "MD", "expense_ratio": 0.19773495698407942}, {"state": "AZ", "expense_ratio": 0.19760114715871627}, {"state": "NJ", "expense_ratio": 0.19601920035269135}, {"state": "VA", "expense_ratio": 0.19521834405283348}, {"state": "FL", "expense_ratio": 0.19432434198199192}, {"state": "IL", "expense_ratio": 0.1943217197591877}, {"state": "PA", "expense_ratio": 0.19140360629270242}, {"state": "GA", "expense_ratio": 0.18950862999652568}, {"state": "WA", "expense_ratio": 0.18903383054657782}, {"state": "IN", "expense_ratio": 0.18823116000792414}, {"state": "TN", "expense_ratio": 0.18069328608022348}, {"state": "CA", "expense_ratio": 0.1775065722249085}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 42.03305557066931}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 9015 in Tennessee?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND state = 'TN'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 38.29870169399624}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8287.10499416764}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total written_premium for AZ?", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE state = 'AZ'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_written_premium": 68116077.48}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total policy_count by state", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "OH", "total_policy_count": 14981}, {"state": "NJ", "total_policy_count": 14244}, {"state": "MA", "total_policy_count": 14178}, {"state": "IL", "total_policy_count": 13577}, {"state": "MD", "total_policy_count": 13575}, {"state": "TN", "total_policy_count": 13205}, {"state": "NC", "total_policy_count": 13135}, {"state": "AZ", "total_policy_count": 12924}, {"state": "WI", "total_policy_count": 12922}, {"state": "WA", "total_policy_count": 12608}, {"state": "FL", "total_policy_count": 12508}, {"state": "PA", "total_policy_count": 12455}, {"state": "TX", "total_policy_count": 12391}, {"state": "MI", "total_policy_count": 11982}, {"state": "GA", "total_policy_count": 11836}, {"state": "VA", "total_policy_count": 11629}, {"state": "MO", "total_policy_count": 11569}, {"state": "IN", "total_policy_count": 11528}, {"state": "CA", "total_policy_count": 11410}, {"state": "NY", "total_policy_count": 10741}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "AZ", "coverage_type": "Commercial Auto", "frequency": 0.005657541991444876}, {"state": "AZ", "coverage_type": "Commercial Property", "frequency": 0.005160274879188937}, {"state": "AZ", "coverage_type": "Workers Compensation", "frequency": 0.004201685061116369}, {"state": "AZ", "coverage_type": "General Liability", "frequency": 0.004103561718761466}, {"state": "WA", "coverage_type": "Commercial Auto", "frequency": 0.006329788550197812}, {"state": "WA", "coverage_type": "Commercial Property", "frequency": 0.005438868989558347}, {"state": "WA", "coverage_type": "General Liability", "frequency": 0.005434264198009928}, {"state": "WA", "coverage_type": "Workers Compensation", "frequency": 0.004706871354840151}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 52.63911229909947}, {"class_code": "8742", "pure_premium": 51.86288890088155}, {"class_code": "8017", "pure_premium": 46.868980179357514}, {"class_code": "9015", "pure_premium": 34.38135928559215}, {"class_code": "8810", "pure_premium": 33.86397946076651}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for TN", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'TN'\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "claim_count": 1210}, {"policy_year": 2020, "claim_count": 1188}, {"policy_year": 2021, "claim_count": 1215}, {"policy_year": 2022, "claim_count": 1372}, {"policy_year": 2023, "claim_count": 1659}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "WA", "rate_per_exposure": 55.139586954698075}, {"state": "GA", "rate_per_exposure": 54.54256069367759}, {"state": "NY", "rate_per_exposure": 54.518606956743774}, {"state": "FL", "rate_per_exposure": 52.97042624267731}, {"state": "TN", "rate_per_exposure": 52.37930237156008}, {"state": "IN", "rate_per_exposure": 52.308985942855685}, {"state": "NC", "rate_per_exposure": 52.054673602394544}, {"state": "OH", "rate_per_exposure": 51.680488248218595}, {"state": "IL", "rate_per_exposure": 50.65911742832912}, {"state": "MO", "rate_per_exposure": 50.65709878122171}, {"state": "PA", "rate_per_exposure": 50.643798587113324}, {"state": "TX", "rate_per_exposure": 50.103654257545124}, {"state": "MA", "rate_per_exposure": 49.99654251470809}, {"state": "CA", "rate_per_exposure": 49.36846459984564}, {"state": "MD", "rate_per_exposure": 48.85429953475044}, {"state": "NJ", "rate_per_exposure": 48.34478955381774}, {"state": "WI", "rate_per_exposure": 48.03167994598623}, {"state": "VA", "rate_per_exposure": 47.88951174864707}, {"state": "MI", "rate_per_exposure": 46.5406529696297}, {"state": "AZ", "rate_per_exposure": 46.490531581590446}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in CA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"industry": "Healthcare", "total_claims": 1181}, {"industry": "Construction", "total_claims": 1038}, {"industry": "Hospitality", "total_claims": 980}, {"industry": "Manufacturing", "total_claims": 951}, {"industry": "Retail", "total_claims": 901}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "FL", "coverage_type": "Commercial Property", "frequency": 0.005662996360472919}, {"state": "FL", "coverage_type": "General Liability", "frequency": 0.004952392626736267}, {"state": "FL", "coverage_type": "Commercial Auto", "frequency": 0.004882603238195369}, {"state": "FL", "coverage_type": "Workers Compensation", "frequency": 0.0048681784090739266}, {"state": "NC", "coverage_type": "Commercial Property", "frequency": 0.005690826185417609}, {"state": "NC", "coverage_type": "Workers Compensation", "frequency": 0.00540485044455505}, {"state": "NC", "coverage_type": "General Liability", "frequency": 0.004989717003489062}, {"state": "NC", "coverage_type": "Commercial Auto", "frequency": 0.004935282997740556}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8810", "pure_premium": 49.813596827020376}, {"class_code": "5190", "pure_premium": 44.94137092083431}, {"class_code": "8017", "pure_premium": 41.78412829729014}, {"class_code": "9015", "pure_premium": 39.91452187360482}, {"class_code": "8820", "pure_premium": 39.00814850912882}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "severity": 8618.780662650603}, {"state": "OH", "severity": 8321.516827418865}, {"state": "AZ", "severity": 8304.086466542485}, {"state": "GA", "severity": 8130.045063752277}, {"state": "TN", "severity": 8106.376149909693}, {"state": "IN", "severity": 8073.489258026951}, {"state": "NJ", "severity": 7999.279705652105}, {"state": "IL", "severity": 7982.989693045563}, {"state": "MI", "severity": 7974.117879428014}, {"state": "MD", "severity": 7840.597223158217}, {"state": "VA", "severity": 7838.676272412708}, {"state": "CA", "severity": 7702.469082693948}, {"state": "NC", "severity": 7594.750243209097}, {"state": "WA", "severity": 7533.9472074468085}, {"state": "MO", "severity": 7528.200220658779}, {"state": "PA", "severity": 7433.6729395098455}, {"state": "TX", "severity": 7410.343162229739}, {"state": "NY", "severity": 7302.356212862635}, {"state": "MA", "severity": 7228.770247320693}, {"state": "WI", "severity": 7226.442057651027}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "5190", "loss_ratio": 2.096485753074742}, {"class_code": "9015", "loss_ratio": 1.4437241238590668}, {"class_code": "8820", "loss_ratio": 1.3336166248839714}, {"class_code": "5506", "loss_ratio": 1.2199954618098237}, {"class_code": "8017", "loss_ratio": 1.1318086785592474}, {"class_code": "5183", "loss_ratio": 1.0077412028043333}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "General Liability", "policy_count": 64479}, {"coverage_type": "Commercial Property", "policy_count": 63851}, {"coverage_type": "Workers Compensation", "policy_count": 63388}, {"coverage_type": "Commercial Auto", "policy_count": 61680}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MI", "coverage_type": "Workers Compensation", "frequency": 0.005889490337579774}, {"state": "MI", "coverage_type": "Commercial Property", "frequency": 0.00544309065189558}, {"state": "MI", "coverage_type": "Commercial Auto", "frequency": 0.005155703876085517}, {"state": "MI", "coverage_type": "General Liability", "frequency": 0.004313442064102136}, {"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "9015", "loss_ratio": 0.9399052526858191}, {"class_code": "5190", "loss_ratio": 0.8641799109696522}, {"class_code": "5183", "loss_ratio": 0.8532723147872501}, {"class_code": "5506", "loss_ratio": 0.6826273498744405}, {"class_code": "8810", "loss_ratio": 0.5434699555377558}, {"class_code": "8820", "loss_ratio": 0.528330449617247}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 9015", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.5848803712824594}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 55.8986367564513}, {"class_code": "8810", "pure_premium": 50.434807821313846}, {"class_code": "8820", "pure_premium": 47.326974642861}, {"class_code": "5190", "pure_premium": 45.19630613640151}, {"class_code": "5183", "pure_premium": 42.28105606745629}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TN", "average_premium": 5487.837104884514}, {"state": "WA", "average_premium": 5419.252912436548}, {"state": "PA", "average_premium": 5404.408096346849}, {"state": "GA", "average_premium": 5330.874493071984}, {"state": "AZ", "average_premium": 5270.510482822656}, {"state": "TX", "average_premium": 5195.763139375354}, {"state": "CA", "average_premium": 5187.9085968448735}, {"state": "IN", "average_premium": 5165.71814018043}, {"state": "VA", "average_premium": 5007.9261217645535}, {"state": "FL", "average_premium": 4993.662469619444}, {"state": "NY", "average_premium": 4971.202810725258}, {"state": "MO", "average_premium": 4912.066315152563}, {"state": "NC", "average_premium": 4811.4407468595355}, {"state": "IL", "average_premium": 4810.454197539957}, {"state": "MA", "average_premium": 4729.088077302864}, {"state": "OH", "average_premium": 4581.627278552834}, {"state": "MI", "average_premium": 4575.9549949924885}, {"state": "MD", "average_premium": 4520.112904604051}, {"state": "WI", "average_premium": 4516.574014858381}, {"state": "NJ", "average_premium": 4506.759422212862}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TX", "loss_ratio": 0.9527072630226262}, {"state": "MA", "loss_ratio": 0.9377115219355888}, {"state": "IN", "loss_ratio": 0.8628327270596653}, {"state": "TN", "loss_ratio": 0.8518487027143875}, {"state": "WA", "loss_ratio": 0.8207302664862852}, {"state": "FL", "loss_ratio": 0.8201673756085506}, {"state": "OH", "loss_ratio": 0.8028637230099516}, {"state": "NJ", "loss_ratio": 0.799628212502186}, {"state": "IL", "loss_ratio": 0.7884231106438916}, {"state": "PA", "loss_ratio": 0.7875883350006327}, {"state": "AZ", "loss_ratio": 0.7832643840745365}, {"state": "WI", "loss_ratio": 0.7782344942184595}, {"state": "MD", "loss_ratio": 0.7469887562444165}, {"state": "MO", "loss_ratio": 0.7389215395562007}, {"state": "NY", "loss_ratio": 0.7153180003622782}, {"state": "VA", "loss_ratio": 0.7079681041879607}, {"state": "GA", "loss_ratio": 0.7045381193082592}, {"state": "MI", "loss_ratio": 0.6767110418929172}, {"state": "CA", "loss_ratio": 0.6558155198648719}, {"state": "NC", "loss_ratio": 0.5630123586721031}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for FL in 2023", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.004778481189273564}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for IL?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.5329817799541723}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NY in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 65.71347313681301}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "TX", "coverage_type": "Commercial Property", "frequency": 0.005787023880955479}, {"state": "TX", "coverage_type": "Commercial Auto", "frequency": 0.00541866466540174}, {"state": "TX", "coverage_type": "Workers Compensation", "frequency": 0.004993892847175561}, {"state": "TX", "coverage_type": "General Liability", "frequency": 0.00494819152181612}, {"state": "WI", "coverage_type": "Commercial Property", "frequency": 0.005893619245835043}, {"state": "WI", "coverage_type": "Commercial Auto", "frequency": 0.005662830159835041}, {"state": "WI", "coverage_type": "Workers Compensation", "frequency": 0.005117575849296508}, {"state": "WI", "coverage_type": "General Liability", "frequency": 0.004776777591583218}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "8017", "loss_ratio": 5.475298460340547}, {"class_code": "5190", "loss_ratio": 3.380876422173969}, {"class_code": "8742", "loss_ratio": 1.5763504738996814}, {"class_code": "5183", "loss_ratio": 0.6609248588320785}, {"class_code": "8810", "loss_ratio": 0.48515858113817917}, {"class_code": "9015", "loss_ratio": 0.42706046607455056}, {"class_code": "5506", "loss_ratio": 0.3834650428687896}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 44.31213053202316}, {"class_code": "5190", "pure_premium": 39.93920839295267}, {"class_code": "8810", "pure_premium": 39.213469307310156}, {"class_code": "9015", "pure_premium": 37.941880828031216}, {"class_code": "8017", "pure_premium": 36.86911551557165}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "8810", "loss_ratio": 1.044455946275772}, {"class_code": "5190", "loss_ratio": 0.7938373106585808}, {"class_code": "5506", "loss_ratio": 0.5389310801282446}, {"class_code": "8017", "loss_ratio": 0.4529201065057758}, {"class_code": "5183", "loss_ratio": 0.36209708876403257}, {"class_code": "8742", "loss_ratio": 0.16911400815540945}, {"class_code": "8820", "loss_ratio": 0.00818874967243504}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "MO", "expense_ratio": 0.21527399302303568}, {"state": "NY", "expense_ratio": 0.21306945111061146}, {"state": "MA", "expense_ratio": 0.2089888150648086}, {"state": "OH", "expense_ratio": 0.20788801640571763}, {"state": "WI", "expense_ratio": 0.20787958057401879}, {"state": "NC", "expense_ratio": 0.2072035574339776}, {"state": "MI", "expense_ratio": 0.20669136094724092}, {"state": "TX", "expense_ratio": 0.20370291149482553}, {"state": "MD", "expense_ratio": 0.19773495698407942}, {"state": "AZ", "expense_ratio": 0.19760114715871627}, {"state": "NJ", "expense_ratio": 0.19601920035269135}, {"state": "VA", "expense_ratio": 0.19521834405283348}, {"state": "FL", "expense_ratio": 0.19432434198199192}, {"state": "IL", "expense_ratio": 0.1943217197591877}, {"state": "PA", "expense_ratio": 0.19140360629270242}, {"state": "GA", "expense_ratio": 0.18950862999652568}, {"state": "WA", "expense_ratio": 0.18903383054657782}, {"state": "IN", "expense_ratio": 0.18823116000792414}, {"state": "TN", "expense_ratio": 0.18069328608022348}, {"state": "CA", "expense_ratio": 0.1775065722249085}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 52.63911229909947}, {"class_code": "8742", "pure_premium": 51.86288890088155}, {"class_code": "8017", "pure_premium": 46.868980179357514}, {"class_code": "9015", "pure_premium": 34.38135928559215}, {"class_code": "8810", "pure_premium": 33.86397946076651}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 51.89402762309435}, {"class_code": "5183", "pure_premium": 49.836514945736035}, {"class_code": "5190", "pure_premium": 43.28508247333897}, {"class_code": "5506", "pure_premium": 43.08539538354736}, {"class_code": "8810", "pure_premium": 36.937337266178616}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2023?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4788.390512805312}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8810", "pure_premium": 49.813596827020376}, {"class_code": "5190", "pure_premium": 44.94137092083431}, {"class_code": "8017", "pure_premium": 41.78412829729014}, {"class_code": "9015", "pure_premium": 39.91452187360482}, {"class_code": "8820", "pure_premium": 39.00814850912882}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 46.19010454634227}, {"class_code": "8742", "pure_premium": 46.08598191058309}, {"class_code": "8810", "pure_premium": 45.27518568725991}, {"class_code": "5183", "pure_premium": 44.94002513787859}, {"class_code": "8820", "pure_premium": 42.16610607563791}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "MO", "expense_ratio": 0.21527399302303568}, {"state": "NY", "expense_ratio": 0.21306945111061146}, {"state": "MA", "expense_ratio": 0.2089888150648086}, {"state": "OH", "expense_ratio": 0.20788801640571763}, {"state": "WI", "expense_ratio": 0.20787958057401879}, {"state": "NC", "expense_ratio": 0.2072035574339776}, {"state": "MI", "expense_ratio": 0.20669136094724092}, {"state": "TX", "expense_ratio": 0.20370291149482553}, {"state": "MD", "expense_ratio": 0.19773495698407942}, {"state": "AZ", "expense_ratio": 0.19760114715871627}, {"state": "NJ", "expense_ratio": 0.19601920035269135}, {"state": "VA", "expense_ratio": 0.19521834405283348}, {"state": "FL", "expense_ratio": 0.19432434198199192}, {"state": "IL", "expense_ratio": 0.1943217197591877}, {"state": "PA", "expense_ratio": 0.19140360629270242}, {"state": "GA", "expense_ratio": 0.18950862999652568}, {"state": "WA", "expense_ratio": 0.18903383054657782}, {"state": "IN", "expense_ratio": 0.18823116000792414}, {"state": "TN", "expense_ratio": 0.18069328608022348}, {"state": "CA", "expense_ratio": 0.1775065722249085}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for WA in 2019", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 0.8664007275962357}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8820", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8820'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005245633185989471}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 55.8986367564513}, {"class_code": "8810", "pure_premium": 50.434807821313846}, {"class_code": "8820", "pure_premium": 47.326974642861}, {"class_code": "5190", "pure_premium": 45.19630613640151}, {"class_code": "5183", "pure_premium": 42.28105606745629}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count trend by year for Massachusetts", "output": "SELECT policy_year, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nWHERE state = 'MA'\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "policy_count": 3362}, {"policy_year": 2020, "policy_count": 2522}, {"policy_year": 2021, "policy_count": 3223}, {"policy_year": 2022, "policy_count": 2109}, {"policy_year": 2023, "policy_count": 2962}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "NY", "coverage_type": "Workers Compensation", "frequency": 0.0060797159640319474}, {"state": "NY", "coverage_type": "Commercial Auto", "frequency": 0.005893728231739281}, {"state": "NY", "coverage_type": "General Liability", "frequency": 0.005891627810555211}, {"state": "NY", "coverage_type": "Commercial Property", "frequency": 0.005466408228316761}, {"state": "OH", "coverage_type": "Workers Compensation", "frequency": 0.006833538373300537}, {"state": "OH", "coverage_type": "Commercial Property", "frequency": 0.004644885713748235}, {"state": "OH", "coverage_type": "General Liability", "frequency": 0.004619240140061332}, {"state": "OH", "coverage_type": "Commercial Auto", "frequency": 0.004316815239931538}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"class_code": "8017", "loss_ratio": 1.9962032202269937}, {"class_code": "5183", "loss_ratio": 1.307033971952564}, {"class_code": "5190", "loss_ratio": 0.6228745337009877}, {"class_code": "8820", "loss_ratio": 0.5282956103039687}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 52.63911229909947}, {"class_code": "8742", "pure_premium": 51.86288890088155}, {"class_code": "8017", "pure_premium": 46.868980179357514}, {"class_code": "9015", "pure_premium": 34.38135928559215}, {"class_code": "8810", "pure_premium": 33.86397946076651}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for OH?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'OH'", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8321.516827418865}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average earned_premium for class code 5506", "output": "SELECT AVG(earned_premium) AS avg_earned_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_earned_premium": 259414.1878513732}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for NC?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NC'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 39.63877479913521}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8810", "loss_ratio": 2.0387908640522223}, {"class_code": "8017", "loss_ratio": 1.4218583479364366}, {"class_code": "5183", "loss_ratio": 1.1113212728681876}, {"class_code": "9015", "loss_ratio": 1.0080634751798296}, {"class_code": "5190", "loss_ratio": 0.4537105601665216}, {"class_code": "8820", "loss_ratio": 0.3090531949152823}, {"class_code": "8742", "loss_ratio": 0.2776029539754114}, {"class_code": "5506", "loss_ratio": 0.07091896265649053}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 51.028235461912764}, {"class_code": "8820", "pure_premium": 47.82638726596499}, {"class_code": "5183", "pure_premium": 40.10071560336792}, {"class_code": "8742", "pure_premium": 40.06677837177819}, {"class_code": "8810", "pure_premium": 38.38427050910045}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "NY", "coverage_type": "Workers Compensation", "frequency": 0.0060797159640319474}, {"state": "NY", "coverage_type": "Commercial Auto", "frequency": 0.005893728231739281}, {"state": "NY", "coverage_type": "General Liability", "frequency": 0.005891627810555211}, {"state": "NY", "coverage_type": "Commercial Property", "frequency": 0.005466408228316761}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8017", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.48428153669182006}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8742", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8742'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005267062988871189}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for MO?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MO'", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7528.200220658779}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2019?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 0.9716813757547043}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 51.89402762309435}, {"class_code": "5183", "pure_premium": 49.836514945736035}, {"class_code": "5190", "pure_premium": 43.28508247333897}, {"class_code": "5506", "pure_premium": 43.08539538354736}, {"class_code": "8810", "pure_premium": 36.937337266178616}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IN", "coverage_type": "Workers Compensation", "frequency": 0.006140999961541943}, {"state": "IN", "coverage_type": "Commercial Auto", "frequency": 0.005220633794959725}, {"state": "IN", "coverage_type": "General Liability", "frequency": 0.005183853945184153}, {"state": "IN", "coverage_type": "Commercial Property", "frequency": 0.004623384416942954}, {"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IL", "coverage_type": "Workers Compensation", "frequency": 0.00540555548697377}, {"state": "IL", "coverage_type": "General Liability", "frequency": 0.004787550378600992}, {"state": "IL", "coverage_type": "Commercial Property", "frequency": 0.0047853414234455575}, {"state": "IL", "coverage_type": "Commercial Auto", "frequency": 0.004596174482039275}, {"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in NY", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'NY'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_incurred_loss": 9531138.52}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "GA", "coverage_type": "Workers Compensation", "frequency": 0.005735867259770458}, {"state": "GA", "coverage_type": "General Liability", "frequency": 0.005523248190918561}, {"state": "GA", "coverage_type": "Commercial Property", "frequency": 0.005255879098857317}, {"state": "GA", "coverage_type": "Commercial Auto", "frequency": 0.004440688289132688}, {"state": "WA", "coverage_type": "Commercial Auto", "frequency": 0.006329788550197812}, {"state": "WA", "coverage_type": "Commercial Property", "frequency": 0.005438868989558347}, {"state": "WA", "coverage_type": "General Liability", "frequency": 0.005434264198009928}, {"state": "WA", "coverage_type": "Workers Compensation", "frequency": 0.004706871354840151}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8017", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8017'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.0052040963922840135}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4934.885191316249}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5183", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.5765719056301458}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for IL?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'IL'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_incurred_loss": 49933600.53}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5190", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.48712425410592597}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'WI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7226.442057651027}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for NJ in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 9284.751296803654}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for GA?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.47279214450772306}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8810", "loss_ratio": 2.0387908640522223}, {"class_code": "8017", "loss_ratio": 1.4218583479364366}, {"class_code": "5183", "loss_ratio": 1.1113212728681876}, {"class_code": "9015", "loss_ratio": 1.0080634751798296}, {"class_code": "5190", "loss_ratio": 0.4537105601665216}, {"class_code": "8820", "loss_ratio": 0.3090531949152823}, {"class_code": "8742", "loss_ratio": 0.2776029539754114}, {"class_code": "5506", "loss_ratio": 0.07091896265649053}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MD?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MD'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7836179956874477}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4885.845592607987}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for WI?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'WI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4516.574014858381}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for NC in 2023", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.6281156082885456}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 51.89402762309435}, {"class_code": "5183", "pure_premium": 49.836514945736035}, {"class_code": "5190", "pure_premium": 43.28508247333897}, {"class_code": "5506", "pure_premium": 43.08539538354736}, {"class_code": "8810", "pure_premium": 36.937337266178616}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "pure_premium": 43.68001996264619}, {"state": "NY", "pure_premium": 42.66280636621263}, {"state": "IN", "pure_premium": 42.62845837490903}, {"state": "GA", "pure_premium": 42.44143813899001}, {"state": "MO", "pure_premium": 41.96906644950354}, {"state": "MI", "pure_premium": 41.65446451508064}, {"state": "OH", "pure_premium": 41.315925594731176}, {"state": "WA", "pure_premium": 41.14914457747659}, {"state": "VA", "pure_premium": 40.98296525858418}, {"state": "MD", "pure_premium": 40.75768258043177}, {"state": "NC", "pure_premium": 39.61037111605624}, {"state": "AZ", "pure_premium": 39.55486823823268}, {"state": "PA", "pure_premium": 39.48035385012789}, {"state": "MA", "pure_premium": 39.23052050225903}, {"state": "TX", "pure_premium": 39.21001978745931}, {"state": "TN", "pure_premium": 38.929288671908814}, {"state": "WI", "pure_premium": 38.78771784056159}, {"state": "IL", "pure_premium": 38.731168534768486}, {"state": "NJ", "pure_premium": 38.47699373391945}, {"state": "CA", "pure_premium": 37.676420942517574}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "severity": 8618.780662650603}, {"state": "OH", "severity": 8321.516827418865}, {"state": "AZ", "severity": 8304.086466542485}, {"state": "GA", "severity": 8130.045063752277}, {"state": "TN", "severity": 8106.376149909693}, {"state": "IN", "severity": 8073.489258026951}, {"state": "NJ", "severity": 7999.279705652105}, {"state": "IL", "severity": 7982.989693045563}, {"state": "MI", "severity": 7974.117879428014}, {"state": "MD", "severity": 7840.597223158217}, {"state": "VA", "severity": 7838.676272412708}, {"state": "CA", "severity": 7702.469082693948}, {"state": "NC", "severity": 7594.750243209097}, {"state": "WA", "severity": 7533.9472074468085}, {"state": "MO", "severity": 7528.200220658779}, {"state": "PA", "severity": 7433.6729395098455}, {"state": "TX", "severity": 7410.343162229739}, {"state": "NY", "severity": 7302.356212862635}, {"state": "MA", "severity": 7228.770247320693}, {"state": "WI", "severity": 7226.442057651027}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "8742", "loss_ratio": 1.5864675248344025}, {"class_code": "5190", "loss_ratio": 1.3000055686753231}, {"class_code": "5183", "loss_ratio": 1.2736901355156116}, {"class_code": "5506", "loss_ratio": 0.8833490764451069}, {"class_code": "8017", "loss_ratio": 0.8245777409429575}, {"class_code": "9015", "loss_ratio": 0.18646856740732473}, {"class_code": "8820", "loss_ratio": 0.14560631739423044}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for IN", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'IN'\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "claim_count": 1142}, {"policy_year": 2020, "claim_count": 1246}, {"policy_year": 2021, "claim_count": 1227}, {"policy_year": 2022, "claim_count": 1287}, {"policy_year": 2023, "claim_count": 1109}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8820", "loss_ratio": 1.1795454393673763}, {"class_code": "5183", "loss_ratio": 1.0863945892931481}, {"class_code": "8017", "loss_ratio": 0.8653159660087573}, {"class_code": "8742", "loss_ratio": 0.7853658606226803}, {"class_code": "9015", "loss_ratio": 0.6498998217829183}, {"class_code": "5190", "loss_ratio": 0.5266719019343532}, {"class_code": "5506", "loss_ratio": 0.44804927740391054}, {"class_code": "8810", "loss_ratio": 0.386838968873602}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "8742", "loss_ratio": 0.79197884131004}, {"class_code": "8810", "loss_ratio": 0.7466998758179312}, {"class_code": "5190", "loss_ratio": 0.4846821013458115}, {"class_code": "8017", "loss_ratio": 0.45139715011013537}, {"class_code": "5183", "loss_ratio": 0.43903879180143285}, {"class_code": "5506", "loss_ratio": 0.19035107428482018}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.55242101992495}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "5183", "loss_ratio": 1.992168888165978}, {"class_code": "8810", "loss_ratio": 1.3094104905794366}, {"class_code": "8017", "loss_ratio": 1.2894925510134987}, {"class_code": "5190", "loss_ratio": 0.9612425831966721}, {"class_code": "8820", "loss_ratio": 0.5235124849025857}, {"class_code": "5506", "loss_ratio": 0.3861554520211617}, {"class_code": "9015", "loss_ratio": 0.34046396527085004}, {"class_code": "8742", "loss_ratio": 0.2271580036849108}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Ohio for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1251}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 46.74144642146194}, {"class_code": "5190", "pure_premium": 45.42509732218632}, {"class_code": "5183", "pure_premium": 44.55027409115304}, {"class_code": "8017", "pure_premium": 40.37850332293974}, {"class_code": "5506", "pure_premium": 40.233852994098875}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 46.74144642146194}, {"class_code": "5190", "pure_premium": 45.42509732218632}, {"class_code": "5183", "pure_premium": 44.55027409115304}, {"class_code": "8017", "pure_premium": 40.37850332293974}, {"class_code": "5506", "pure_premium": 40.233852994098875}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 50.5089744354891}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "NY", "frequency": 0.005842334326428065}, {"state": "MO", "frequency": 0.005574913687116429}, {"state": "WA", "frequency": 0.005461830756764978}, {"state": "MA", "frequency": 0.005426997837813372}, {"state": "WI", "frequency": 0.005367470953357319}, {"state": "PA", "frequency": 0.005311015721486814}, {"state": "TX", "frequency": 0.005291255604370849}, {"state": "IN", "frequency": 0.005280053891509957}, {"state": "VA", "frequency": 0.005228301799223278}, {"state": "MI", "frequency": 0.0052237081448899434}, {"state": "GA", "frequency": 0.005220320158889982}, {"state": "NC", "frequency": 0.005215493577484546}, {"state": "MD", "frequency": 0.005198288015618081}, {"state": "FL", "frequency": 0.005068004590479151}, {"state": "OH", "frequency": 0.004964951276502602}, {"state": "CA", "frequency": 0.004891473180615508}, {"state": "IL", "frequency": 0.004851712206081064}, {"state": "NJ", "frequency": 0.0048100572988756096}, {"state": "TN", "frequency": 0.00480230474776852}, {"state": "AZ", "frequency": 0.004763301586225157}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 46.74144642146194}, {"class_code": "5190", "pure_premium": 45.42509732218632}, {"class_code": "5183", "pure_premium": 44.55027409115304}, {"class_code": "8017", "pure_premium": 40.37850332293974}, {"class_code": "5506", "pure_premium": 40.233852994098875}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "WI", "reserve_ratio": 0.5413736382644159}, {"state": "MO", "reserve_ratio": 0.5341641158452941}, {"state": "IL", "reserve_ratio": 0.5329817799541723}, {"state": "NC", "reserve_ratio": 0.5277701245861793}, {"state": "MA", "reserve_ratio": 0.5199079774546557}, {"state": "TX", "reserve_ratio": 0.5193077177541042}, {"state": "WA", "reserve_ratio": 0.5145507801393678}, {"state": "FL", "reserve_ratio": 0.5092773986933368}, {"state": "MD", "reserve_ratio": 0.5022521064463745}, {"state": "CA", "reserve_ratio": 0.49860490135540214}, {"state": "MI", "reserve_ratio": 0.49758912443507414}, {"state": "NY", "reserve_ratio": 0.4962413427184941}, {"state": "PA", "reserve_ratio": 0.4960151914205872}, {"state": "TN", "reserve_ratio": 0.4935634333246963}, {"state": "NJ", "reserve_ratio": 0.49286408077072313}, {"state": "OH", "reserve_ratio": 0.4858888917215781}, {"state": "IN", "reserve_ratio": 0.4799720227990084}, {"state": "VA", "reserve_ratio": 0.479617927301472}, {"state": "AZ", "reserve_ratio": 0.4783599588278123}, {"state": "GA", "reserve_ratio": 0.47279214450772306}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 55.8986367564513}, {"class_code": "8810", "pure_premium": 50.434807821313846}, {"class_code": "8820", "pure_premium": 47.326974642861}, {"class_code": "5190", "pure_premium": 45.19630613640151}, {"class_code": "5183", "pure_premium": 42.28105606745629}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 44.31213053202316}, {"class_code": "5190", "pure_premium": 39.93920839295267}, {"class_code": "8810", "pure_premium": 39.213469307310156}, {"class_code": "9015", "pure_premium": 37.941880828031216}, {"class_code": "8017", "pure_premium": 36.86911551557165}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MD", "coverage_type": "Commercial Property", "frequency": 0.005651827092235917}, {"state": "MD", "coverage_type": "Workers Compensation", "frequency": 0.005394802870849437}, {"state": "MD", "coverage_type": "Commercial Auto", "frequency": 0.005104930991000689}, {"state": "MD", "coverage_type": "General Liability", "frequency": 0.004581416058435962}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8820", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8820'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005245633185989471}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "8742", "loss_ratio": 1.3812439976968653}, {"class_code": "9015", "loss_ratio": 1.3702877810520753}, {"class_code": "8810", "loss_ratio": 0.7561370622406284}, {"class_code": "5506", "loss_ratio": 0.575911525273842}, {"class_code": "5183", "loss_ratio": 0.5022385371483441}, {"class_code": "8820", "loss_ratio": 0.3701816180949575}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}, {"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "NY", "frequency": 0.005842334326428065}, {"state": "MO", "frequency": 0.005574913687116429}, {"state": "WA", "frequency": 0.005461830756764978}, {"state": "MA", "frequency": 0.005426997837813372}, {"state": "WI", "frequency": 0.005367470953357319}, {"state": "PA", "frequency": 0.005311015721486814}, {"state": "TX", "frequency": 0.005291255604370849}, {"state": "IN", "frequency": 0.005280053891509957}, {"state": "VA", "frequency": 0.005228301799223278}, {"state": "MI", "frequency": 0.0052237081448899434}, {"state": "GA", "frequency": 0.005220320158889982}, {"state": "NC", "frequency": 0.005215493577484546}, {"state": "MD", "frequency": 0.005198288015618081}, {"state": "FL", "frequency": 0.005068004590479151}, {"state": "OH", "frequency": 0.004964951276502602}, {"state": "CA", "frequency": 0.004891473180615508}, {"state": "IL", "frequency": 0.004851712206081064}, {"state": "NJ", "frequency": 0.0048100572988756096}, {"state": "TN", "frequency": 0.00480230474776852}, {"state": "AZ", "frequency": 0.004763301586225157}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MO?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7525338450202093}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2022 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "VA", "loss_ratio": 1.1047503959311864}, {"state": "NY", "loss_ratio": 0.9823235921404354}, {"state": "NJ", "loss_ratio": 0.9284268370709049}, {"state": "MA", "loss_ratio": 0.9124631517160617}, {"state": "TN", "loss_ratio": 0.8836009508723472}, {"state": "IN", "loss_ratio": 0.8643527553062677}, {"state": "GA", "loss_ratio": 0.839971112686931}, {"state": "MD", "loss_ratio": 0.8317440722533425}, {"state": "WI", "loss_ratio": 0.8273003358987839}, {"state": "MI", "loss_ratio": 0.8211774015334324}, {"state": "OH", "loss_ratio": 0.8184168097144487}, {"state": "PA", "loss_ratio": 0.8009962565719576}, {"state": "WA", "loss_ratio": 0.7888210366688995}, {"state": "AZ", "loss_ratio": 0.7605385429580296}, {"state": "IL", "loss_ratio": 0.7544354771693752}, {"state": "FL", "loss_ratio": 0.7331733175307031}, {"state": "MO", "loss_ratio": 0.722776186858719}, {"state": "CA", "loss_ratio": 0.7184649975185508}, {"state": "NC", "loss_ratio": 0.7034363478400331}, {"state": "TX", "loss_ratio": 0.627099288713596}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Workers Compensation in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7591.370926652142}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "GA", "coverage_type": "Workers Compensation", "frequency": 0.005735867259770458}, {"state": "GA", "coverage_type": "General Liability", "frequency": 0.005523248190918561}, {"state": "GA", "coverage_type": "Commercial Property", "frequency": 0.005255879098857317}, {"state": "GA", "coverage_type": "Commercial Auto", "frequency": 0.004440688289132688}, {"state": "MI", "coverage_type": "Workers Compensation", "frequency": 0.005889490337579774}, {"state": "MI", "coverage_type": "Commercial Property", "frequency": 0.00544309065189558}, {"state": "MI", "coverage_type": "Commercial Auto", "frequency": 0.005155703876085517}, {"state": "MI", "coverage_type": "General Liability", "frequency": 0.004313442064102136}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 5506", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '5506'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_paid_loss": 152368.1489983845}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MI", "coverage_type": "Workers Compensation", "frequency": 0.005889490337579774}, {"state": "MI", "coverage_type": "Commercial Property", "frequency": 0.00544309065189558}, {"state": "MI", "coverage_type": "Commercial Auto", "frequency": 0.005155703876085517}, {"state": "MI", "coverage_type": "General Liability", "frequency": 0.004313442064102136}, {"state": "OH", "coverage_type": "Workers Compensation", "frequency": 0.006833538373300537}, {"state": "OH", "coverage_type": "Commercial Property", "frequency": 0.004644885713748235}, {"state": "OH", "coverage_type": "General Liability", "frequency": 0.004619240140061332}, {"state": "OH", "coverage_type": "Commercial Auto", "frequency": 0.004316815239931538}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total incurred_loss by state", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "AZ", "total_incurred_loss": 57954219.45}, {"state": "OH", "total_incurred_loss": 54872081.96}, {"state": "TN", "total_incurred_loss": 53858763.14}, {"state": "MA", "total_incurred_loss": 52610989.86}, {"state": "PA", "total_incurred_loss": 52474297.28}, {"state": "FL", "total_incurred_loss": 51505833.24}, {"state": "MD", "total_incurred_loss": 51191259.27}, {"state": "NJ", "total_incurred_loss": 51091399.48}, {"state": "WA", "total_incurred_loss": 50989754.7}, {"state": "TX", "total_incurred_loss": 50382923.16}, {"state": "IL", "total_incurred_loss": 49933600.53}, {"state": "VA", "total_incurred_loss": 49838303.74}, {"state": "GA", "total_incurred_loss": 49097342.14}, {"state": "MI", "total_incurred_loss": 49072721.43}, {"state": "IN", "total_incurred_loss": 48529743.93}, {"state": "NC", "total_incurred_loss": 48089958.54}, {"state": "WI", "total_incurred_loss": 47130855.1}, {"state": "MO", "total_incurred_loss": 47081364.18}, {"state": "CA", "total_incurred_loss": 45174981.17}, {"state": "NY", "total_incurred_loss": 41784082.25}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for NJ in 2022", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.7062996559730546}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for MI?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.5982253384452179}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "WA", "rate_per_exposure": 55.139586954698075}, {"state": "GA", "rate_per_exposure": 54.54256069367759}, {"state": "NY", "rate_per_exposure": 54.518606956743774}, {"state": "FL", "rate_per_exposure": 52.97042624267731}, {"state": "TN", "rate_per_exposure": 52.37930237156008}, {"state": "IN", "rate_per_exposure": 52.308985942855685}, {"state": "NC", "rate_per_exposure": 52.054673602394544}, {"state": "OH", "rate_per_exposure": 51.680488248218595}, {"state": "IL", "rate_per_exposure": 50.65911742832912}, {"state": "MO", "rate_per_exposure": 50.65709878122171}, {"state": "PA", "rate_per_exposure": 50.643798587113324}, {"state": "TX", "rate_per_exposure": 50.103654257545124}, {"state": "MA", "rate_per_exposure": 49.99654251470809}, {"state": "CA", "rate_per_exposure": 49.36846459984564}, {"state": "MD", "rate_per_exposure": 48.85429953475044}, {"state": "NJ", "rate_per_exposure": 48.34478955381774}, {"state": "WI", "rate_per_exposure": 48.03167994598623}, {"state": "VA", "rate_per_exposure": 47.88951174864707}, {"state": "MI", "rate_per_exposure": 46.5406529696297}, {"state": "AZ", "rate_per_exposure": 46.490531581590446}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "NC", "coverage_type": "Commercial Property", "frequency": 0.005690826185417609}, {"state": "NC", "coverage_type": "Workers Compensation", "frequency": 0.00540485044455505}, {"state": "NC", "coverage_type": "General Liability", "frequency": 0.004989717003489062}, {"state": "NC", "coverage_type": "Commercial Auto", "frequency": 0.004935282997740556}, {"state": "NY", "coverage_type": "Workers Compensation", "frequency": 0.0060797159640319474}, {"state": "NY", "coverage_type": "Commercial Auto", "frequency": 0.005893728231739281}, {"state": "NY", "coverage_type": "General Liability", "frequency": 0.005891627810555211}, {"state": "NY", "coverage_type": "Commercial Property", "frequency": 0.005466408228316761}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in TN for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1215}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 6993.617408764941}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5190", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.18808488931693493}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5190", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.18808488931693493}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 52.982921155836024}, {"class_code": "5190", "pure_premium": 49.239914767899556}, {"class_code": "9015", "pure_premium": 47.22988943565774}, {"class_code": "8742", "pure_premium": 43.78593669250885}, {"class_code": "8017", "pure_premium": 43.430791590333804}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}, {"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5081.1318969701715}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for GA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 54.54256069367759}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8820", "pure_premium": 46.78005886503411}, {"class_code": "5506", "pure_premium": 43.68825442086105}, {"class_code": "8810", "pure_premium": 37.684764668798614}, {"class_code": "9015", "pure_premium": 37.06410294297614}, {"class_code": "8017", "pure_premium": 35.174899049762104}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 9015", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.5130964872790715}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10", "ground_truth": {"success": true, "row_count": 10, "data": [{"state": "TN", "total_written_premium": 72466888.97}, {"state": "OH", "total_written_premium": 68637358.26}, {"state": "WA", "total_written_premium": 68325940.72}, {"state": "AZ", "total_written_premium": 68116077.48}, {"state": "PA", "total_written_premium": 67311902.84}, {"state": "MA", "total_written_premium": 67049010.76}, {"state": "IL", "total_written_premium": 65311536.64}, {"state": "TX", "total_written_premium": 64380701.06}, {"state": "NJ", "total_written_premium": 64194281.21}, {"state": "NC", "total_written_premium": 63198274.21}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "AZ", "coverage_type": "Commercial Auto", "frequency": 0.005657541991444876}, {"state": "AZ", "coverage_type": "Commercial Property", "frequency": 0.005160274879188937}, {"state": "AZ", "coverage_type": "Workers Compensation", "frequency": 0.004201685061116369}, {"state": "AZ", "coverage_type": "General Liability", "frequency": 0.004103561718761466}, {"state": "OH", "coverage_type": "Workers Compensation", "frequency": 0.006833538373300537}, {"state": "OH", "coverage_type": "Commercial Property", "frequency": 0.004644885713748235}, {"state": "OH", "coverage_type": "General Liability", "frequency": 0.004619240140061332}, {"state": "OH", "coverage_type": "Commercial Auto", "frequency": 0.004316815239931538}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8810", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.6062950277340589}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 9015 in Georgia?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.82558989526317}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for NY?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7575498625643559}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "FL", "coverage_type": "Commercial Property", "frequency": 0.005662996360472919}, {"state": "FL", "coverage_type": "General Liability", "frequency": 0.004952392626736267}, {"state": "FL", "coverage_type": "Commercial Auto", "frequency": 0.004882603238195369}, {"state": "FL", "coverage_type": "Workers Compensation", "frequency": 0.0048681784090739266}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8820", "pure_premium": 46.78005886503411}, {"class_code": "5506", "pure_premium": 43.68825442086105}, {"class_code": "8810", "pure_premium": 37.684764668798614}, {"class_code": "9015", "pure_premium": 37.06410294297614}, {"class_code": "8017", "pure_premium": 35.174899049762104}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 8820", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_written_premium": 250370.14289855075}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8074683637449888}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for NY in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 46.243286014420846}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for WI in 2023", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4407.681478715459}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 44.31213053202316}, {"class_code": "5190", "pure_premium": 39.93920839295267}, {"class_code": "8810", "pure_premium": 39.213469307310156}, {"class_code": "9015", "pure_premium": 37.941880828031216}, {"class_code": "8017", "pure_premium": 36.86911551557165}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "loss_ratio": 0.7760977890485724}, {"policy_year": 2020, "loss_ratio": 0.7930309156972392}, {"policy_year": 2021, "loss_ratio": 0.8281007111390667}, {"policy_year": 2022, "loss_ratio": 0.8074683637449888}, {"policy_year": 2023, "loss_ratio": 0.7756072033418562}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.20444266398452438}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4729.088077302864}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Virginia?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8179525370618772}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 42.44143813899001}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IL", "coverage_type": "Workers Compensation", "frequency": 0.00540555548697377}, {"state": "IL", "coverage_type": "General Liability", "frequency": 0.004787550378600992}, {"state": "IL", "coverage_type": "Commercial Property", "frequency": 0.0047853414234455575}, {"state": "IL", "coverage_type": "Commercial Auto", "frequency": 0.004596174482039275}, {"state": "MI", "coverage_type": "Workers Compensation", "frequency": 0.005889490337579774}, {"state": "MI", "coverage_type": "Commercial Property", "frequency": 0.00544309065189558}, {"state": "MI", "coverage_type": "Commercial Auto", "frequency": 0.005155703876085517}, {"state": "MI", "coverage_type": "General Liability", "frequency": 0.004313442064102136}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for VA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8179525370618772}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MA", "coverage_type": "General Liability", "frequency": 0.005757060987778602}, {"state": "MA", "coverage_type": "Workers Compensation", "frequency": 0.005476079556605489}, {"state": "MA", "coverage_type": "Commercial Property", "frequency": 0.00541962011636064}, {"state": "MA", "coverage_type": "Commercial Auto", "frequency": 0.005015564207657125}, {"state": "WA", "coverage_type": "Commercial Auto", "frequency": 0.006329788550197812}, {"state": "WA", "coverage_type": "Commercial Property", "frequency": 0.005438868989558347}, {"state": "WA", "coverage_type": "General Liability", "frequency": 0.005434264198009928}, {"state": "WA", "coverage_type": "Workers Compensation", "frequency": 0.004706871354840151}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for NJ?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.49286408077072313}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8085.209905468296}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TX'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 39.21001978745931}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "TN", "coverage_type": "General Liability", "frequency": 0.005702595453595276}, {"state": "TN", "coverage_type": "Commercial Property", "frequency": 0.00499713846913048}, {"state": "TN", "coverage_type": "Workers Compensation", "frequency": 0.004349168053315909}, {"state": "TN", "coverage_type": "Commercial Auto", "frequency": 0.004255940076363725}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NJ in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 54.86868430550521}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5190", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.5797756232411331}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in WI", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WI'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"industry": "Hospitality", "total_claims": 1259}, {"industry": "Retail", "total_claims": 1254}, {"industry": "Technology", "total_claims": 1110}, {"industry": "Manufacturing", "total_claims": 1056}, {"industry": "Healthcare", "total_claims": 1016}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 51.24461964357669}, {"class_code": "8017", "pure_premium": 45.34352326087986}, {"class_code": "8742", "pure_premium": 43.795096659749305}, {"class_code": "8810", "pure_premium": 43.64242009455048}, {"class_code": "5506", "pure_premium": 41.014829375242456}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}, {"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total exposure_units for IL?", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE state = 'IL'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_exposure_units": 1289235.58}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by earned_premium", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 10", "ground_truth": {"success": true, "row_count": 10, "data": [{"state": "AZ", "total_earned_premium": 69687084.75}, {"state": "WA", "total_earned_premium": 69013192.94}, {"state": "OH", "total_earned_premium": 67599579.32}, {"state": "NC", "total_earned_premium": 66357030.66}, {"state": "MA", "total_earned_premium": 66027298.06}, {"state": "TX", "total_earned_premium": 65514658.21}, {"state": "MD", "total_earned_premium": 65326804.07}, {"state": "NJ", "total_earned_premium": 64987777.52}, {"state": "PA", "total_earned_premium": 64346578.51}, {"state": "TN", "total_earned_premium": 64220126.32}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.20444266398452438}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TN", "combined_ratio": 1.042555461606884}, {"state": "IN", "combined_ratio": 1.040405579015794}, {"state": "MI", "combined_ratio": 1.0395517437673527}, {"state": "IL", "combined_ratio": 1.0336624401898906}, {"state": "GA", "combined_ratio": 1.0276079461054288}, {"state": "AZ", "combined_ratio": 1.0247814893705967}, {"state": "OH", "combined_ratio": 1.0228017232578246}, {"state": "PA", "combined_ratio": 1.0157189355428249}, {"state": "FL", "combined_ratio": 1.0090584867010584}, {"state": "MA", "combined_ratio": 1.0090293731156201}, {"state": "VA", "combined_ratio": 1.0045414178584007}, {"state": "WI", "combined_ratio": 0.9806038774418532}, {"state": "NJ", "combined_ratio": 0.9797951796459586}, {"state": "MD", "combined_ratio": 0.9693476125381194}, {"state": "TX", "combined_ratio": 0.9692099622418223}, {"state": "NY", "combined_ratio": 0.963815907455949}, {"state": "MO", "combined_ratio": 0.9480706919528827}, {"state": "CA", "combined_ratio": 0.9312948882444255}, {"state": "WA", "combined_ratio": 0.925992064380495}, {"state": "NC", "combined_ratio": 0.9220555104929103}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "General Liability", "policy_count": 64479}, {"coverage_type": "Commercial Property", "policy_count": 63851}, {"coverage_type": "Workers Compensation", "policy_count": 63388}, {"coverage_type": "Commercial Auto", "policy_count": 61680}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for MA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8258.673723986856}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "5190", "loss_ratio": 1.8772047861861434}, {"class_code": "5183", "loss_ratio": 1.283127947157581}, {"class_code": "8017", "loss_ratio": 0.961785962468007}, {"class_code": "9015", "loss_ratio": 0.7299407665531938}, {"class_code": "8742", "loss_ratio": 0.3983016082354841}, {"class_code": "8820", "loss_ratio": 0.09120940136748214}, {"class_code": "5506", "loss_ratio": 0.08330079451640536}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8166178755302055}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"coverage_type": "Commercial Property", "frequency": 0.0052565481573056344}, {"coverage_type": "Workers Compensation", "frequency": 0.005159983360541934}, {"coverage_type": "Commercial Auto", "frequency": 0.005154504944301332}, {"coverage_type": "General Liability", "frequency": 0.00512316903762606}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "NY", "coverage_type": "Workers Compensation", "frequency": 0.0060797159640319474}, {"state": "NY", "coverage_type": "Commercial Auto", "frequency": 0.005893728231739281}, {"state": "NY", "coverage_type": "General Liability", "frequency": 0.005891627810555211}, {"state": "NY", "coverage_type": "Commercial Property", "frequency": 0.005466408228316761}, {"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for AZ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'AZ'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5270.510482822656}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average incurred_loss for class code 5183", "output": "SELECT AVG(incurred_loss) AS avg_incurred_loss\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_incurred_loss": 200962.14492913385}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count trend by year for Washington", "output": "SELECT policy_year, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nWHERE state = 'WA'\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "policy_count": 2949}, {"policy_year": 2020, "policy_count": 1934}, {"policy_year": 2021, "policy_count": 2952}, {"policy_year": 2022, "policy_count": 2284}, {"policy_year": 2023, "policy_count": 2489}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "pure_premium": 43.68001996264619}, {"state": "NY", "pure_premium": 42.66280636621263}, {"state": "IN", "pure_premium": 42.62845837490903}, {"state": "GA", "pure_premium": 42.44143813899001}, {"state": "MO", "pure_premium": 41.96906644950354}, {"state": "MI", "pure_premium": 41.65446451508064}, {"state": "OH", "pure_premium": 41.315925594731176}, {"state": "WA", "pure_premium": 41.14914457747659}, {"state": "VA", "pure_premium": 40.98296525858418}, {"state": "MD", "pure_premium": 40.75768258043177}, {"state": "NC", "pure_premium": 39.61037111605624}, {"state": "AZ", "pure_premium": 39.55486823823268}, {"state": "PA", "pure_premium": 39.48035385012789}, {"state": "MA", "pure_premium": 39.23052050225903}, {"state": "TX", "pure_premium": 39.21001978745931}, {"state": "TN", "pure_premium": 38.929288671908814}, {"state": "WI", "pure_premium": 38.78771784056159}, {"state": "IL", "pure_premium": 38.731168534768486}, {"state": "NJ", "pure_premium": 38.47699373391945}, {"state": "CA", "pure_premium": 37.676420942517574}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "loss_ratio": 1.0237079753445122}, {"class_code": "9015", "loss_ratio": 0.5804416883909257}, {"class_code": "5506", "loss_ratio": 0.5393544382083022}, {"class_code": "5190", "loss_ratio": 0.5345494030578488}, {"class_code": "8820", "loss_ratio": 0.2562488102671649}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "WI", "reserve_ratio": 0.5413736382644159}, {"state": "MO", "reserve_ratio": 0.5341641158452941}, {"state": "IL", "reserve_ratio": 0.5329817799541723}, {"state": "NC", "reserve_ratio": 0.5277701245861793}, {"state": "MA", "reserve_ratio": 0.5199079774546557}, {"state": "TX", "reserve_ratio": 0.5193077177541042}, {"state": "WA", "reserve_ratio": 0.5145507801393678}, {"state": "FL", "reserve_ratio": 0.5092773986933368}, {"state": "MD", "reserve_ratio": 0.5022521064463745}, {"state": "CA", "reserve_ratio": 0.49860490135540214}, {"state": "MI", "reserve_ratio": 0.49758912443507414}, {"state": "NY", "reserve_ratio": 0.4962413427184941}, {"state": "PA", "reserve_ratio": 0.4960151914205872}, {"state": "TN", "reserve_ratio": 0.4935634333246963}, {"state": "NJ", "reserve_ratio": 0.49286408077072313}, {"state": "OH", "reserve_ratio": 0.4858888917215781}, {"state": "IN", "reserve_ratio": 0.4799720227990084}, {"state": "VA", "reserve_ratio": 0.479617927301472}, {"state": "AZ", "reserve_ratio": 0.4783599588278123}, {"state": "GA", "reserve_ratio": 0.47279214450772306}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Arizona?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.831635010388349}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for FL in 2019", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.00466718380794517}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2021?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.4918653679287034}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IL", "paid_loss_ratio": 0.6656084286471571}, {"state": "WI", "paid_loss_ratio": 0.649880308491589}, {"state": "TX", "paid_loss_ratio": 0.6365016152009015}, {"state": "NJ", "paid_loss_ratio": 0.6334580352025554}, {"state": "TN", "paid_loss_ratio": 0.6252360868915836}, {"state": "GA", "paid_loss_ratio": 0.6228810480946463}, {"state": "MA", "paid_loss_ratio": 0.6140812956355586}, {"state": "VA", "paid_loss_ratio": 0.6088244274113939}, {"state": "MI", "paid_loss_ratio": 0.5982253384452179}, {"state": "IN", "paid_loss_ratio": 0.59453587121206}, {"state": "PA", "paid_loss_ratio": 0.5940486067034554}, {"state": "OH", "paid_loss_ratio": 0.5826399525883914}, {"state": "NY", "paid_loss_ratio": 0.5782333868674466}, {"state": "MO", "paid_loss_ratio": 0.574488033915724}, {"state": "FL", "paid_loss_ratio": 0.5721854822888148}, {"state": "MD", "paid_loss_ratio": 0.5629059676728803}, {"state": "NC", "paid_loss_ratio": 0.5610174722968836}, {"state": "CA", "paid_loss_ratio": 0.5525875028003563}, {"state": "AZ", "paid_loss_ratio": 0.5382113627590083}, {"state": "WA", "paid_loss_ratio": 0.5371712064131023}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "8017", "loss_ratio": 2.2772427051671733}, {"class_code": "5183", "loss_ratio": 1.8390087762287535}, {"class_code": "9015", "loss_ratio": 0.7070383382098705}, {"class_code": "5190", "loss_ratio": 0.6919292978816055}, {"class_code": "5506", "loss_ratio": 0.46900463335262854}, {"class_code": "8742", "loss_ratio": 0.4247780992856971}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2021?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.4918653679287034}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "8810", "loss_ratio": 1.7828709137617602}, {"class_code": "8017", "loss_ratio": 1.5186714684193352}, {"class_code": "5506", "loss_ratio": 1.1809482976296557}, {"class_code": "9015", "loss_ratio": 1.1256162420256002}, {"class_code": "5190", "loss_ratio": 0.9292655926622453}, {"class_code": "8820", "loss_ratio": 0.3001581024723808}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 49.098322051228585}, {"class_code": "8017", "pure_premium": 45.87504837461007}, {"class_code": "5506", "pure_premium": 43.96659250422684}, {"class_code": "5183", "pure_premium": 43.34234216528388}, {"class_code": "8820", "pure_premium": 42.70456399968589}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8445207747120288}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7922562362105812}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MD", "coverage_type": "Commercial Property", "frequency": 0.005651827092235917}, {"state": "MD", "coverage_type": "Workers Compensation", "frequency": 0.005394802870849437}, {"state": "MD", "coverage_type": "Commercial Auto", "frequency": 0.005104930991000689}, {"state": "MD", "coverage_type": "General Liability", "frequency": 0.004581416058435962}, {"state": "NC", "coverage_type": "Commercial Property", "frequency": 0.005690826185417609}, {"state": "NC", "coverage_type": "Workers Compensation", "frequency": 0.00540485044455505}, {"state": "NC", "coverage_type": "General Liability", "frequency": 0.004989717003489062}, {"state": "NC", "coverage_type": "Commercial Auto", "frequency": 0.004935282997740556}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MD", "coverage_type": "Commercial Property", "frequency": 0.005651827092235917}, {"state": "MD", "coverage_type": "Workers Compensation", "frequency": 0.005394802870849437}, {"state": "MD", "coverage_type": "Commercial Auto", "frequency": 0.005104930991000689}, {"state": "MD", "coverage_type": "General Liability", "frequency": 0.004581416058435962}, {"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Michigan for 2020?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1200}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 6993.617408764941}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count for Workers Compensation in California", "output": "SELECT SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'CA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_policy_count": 3014}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MA", "coverage_type": "General Liability", "frequency": 0.005757060987778602}, {"state": "MA", "coverage_type": "Workers Compensation", "frequency": 0.005476079556605489}, {"state": "MA", "coverage_type": "Commercial Property", "frequency": 0.00541962011636064}, {"state": "MA", "coverage_type": "Commercial Auto", "frequency": 0.005015564207657125}, {"state": "MO", "coverage_type": "General Liability", "frequency": 0.005890546308464511}, {"state": "MO", "coverage_type": "Commercial Property", "frequency": 0.005757872213977431}, {"state": "MO", "coverage_type": "Commercial Auto", "frequency": 0.0055859103675307}, {"state": "MO", "coverage_type": "Workers Compensation", "frequency": 0.005046707701250297}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7783.181441484127}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "AZ", "total_exposure_units": 1465160.22}, {"state": "TN", "total_exposure_units": 1383502.37}, {"state": "MA", "total_exposure_units": 1341072.95}, {"state": "PA", "total_exposure_units": 1329124.29}, {"state": "OH", "total_exposure_units": 1328109.71}, {"state": "NJ", "total_exposure_units": 1327842.81}, {"state": "IL", "total_exposure_units": 1289235.58}, {"state": "TX", "total_exposure_units": 1284950.21}, {"state": "MD", "total_exposure_units": 1255990.43}, {"state": "WA", "total_exposure_units": 1239144.95}, {"state": "VA", "total_exposure_units": 1216073.64}, {"state": "WI", "total_exposure_units": 1215097.4}, {"state": "NC", "total_exposure_units": 1214074.93}, {"state": "CA", "total_exposure_units": 1199025.28}, {"state": "FL", "total_exposure_units": 1179162.31}, {"state": "MI", "total_exposure_units": 1178090.32}, {"state": "GA", "total_exposure_units": 1156825.6}, {"state": "IN", "total_exposure_units": 1138435.35}, {"state": "MO", "total_exposure_units": 1121811.09}, {"state": "NY", "total_exposure_units": 979403.04}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MO?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7525338450202093}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 44.31213053202316}, {"class_code": "5190", "pure_premium": 39.93920839295267}, {"class_code": "8810", "pure_premium": 39.213469307310156}, {"class_code": "9015", "pure_premium": 37.941880828031216}, {"class_code": "8017", "pure_premium": 36.86911551557165}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "OH", "coverage_type": "Workers Compensation", "frequency": 0.006833538373300537}, {"state": "OH", "coverage_type": "Commercial Property", "frequency": 0.004644885713748235}, {"state": "OH", "coverage_type": "General Liability", "frequency": 0.004619240140061332}, {"state": "OH", "coverage_type": "Commercial Auto", "frequency": 0.004316815239931538}, {"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"class_code": "5183", "loss_ratio": 2.4146411085458386}, {"class_code": "5190", "loss_ratio": 0.8735187405987311}, {"class_code": "5506", "loss_ratio": 0.526976217060219}, {"class_code": "8810", "loss_ratio": 0.38502842822002104}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8305.77488902685}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2023?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4788.390512805312}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8017", "loss_ratio": 0.8186423809168404}, {"class_code": "8810", "loss_ratio": 0.8170132186239819}, {"class_code": "9015", "loss_ratio": 0.808349495370977}, {"class_code": "5190", "loss_ratio": 0.8030004927646215}, {"class_code": "5183", "loss_ratio": 0.793463638744717}, {"class_code": "8742", "loss_ratio": 0.7922562362105812}, {"class_code": "8820", "loss_ratio": 0.7873688351977517}, {"class_code": "5506", "loss_ratio": 0.744577786250857}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8820", "loss_ratio": 1.1795454393673763}, {"class_code": "5183", "loss_ratio": 1.0863945892931481}, {"class_code": "8017", "loss_ratio": 0.8653159660087573}, {"class_code": "8742", "loss_ratio": 0.7853658606226803}, {"class_code": "9015", "loss_ratio": 0.6498998217829183}, {"class_code": "5190", "loss_ratio": 0.5266719019343532}, {"class_code": "5506", "loss_ratio": 0.44804927740391054}, {"class_code": "8810", "loss_ratio": 0.386838968873602}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8810", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 1.0153420254864853}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8745.98367720199}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for NY?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'", "ground_truth": {"success": true, "row_count": 1, "data": [{"reserve_ratio": 0.4962413427184941}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"class_code": "5183", "loss_ratio": 2.4146411085458386}, {"class_code": "5190", "loss_ratio": 0.8735187405987311}, {"class_code": "5506", "loss_ratio": 0.526976217060219}, {"class_code": "8810", "loss_ratio": 0.38502842822002104}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TN'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.8386586297203659}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7930309156972392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "OH", "coverage_type": "Workers Compensation", "frequency": 0.006833538373300537}, {"state": "OH", "coverage_type": "Commercial Property", "frequency": 0.004644885713748235}, {"state": "OH", "coverage_type": "General Liability", "frequency": 0.004619240140061332}, {"state": "OH", "coverage_type": "Commercial Auto", "frequency": 0.004316815239931538}, {"state": "PA", "coverage_type": "Workers Compensation", "frequency": 0.005802344944969561}, {"state": "PA", "coverage_type": "Commercial Property", "frequency": 0.005699950076299332}, {"state": "PA", "coverage_type": "General Liability", "frequency": 0.0050471228766923795}, {"state": "PA", "coverage_type": "Commercial Auto", "frequency": 0.004774589063949548}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5183", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.1892947588979174}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 44.42204464474976}, {"class_code": "5506", "pure_premium": 43.60392917649229}, {"class_code": "5190", "pure_premium": 43.437078937146076}, {"class_code": "8820", "pure_premium": 41.1911920874482}, {"class_code": "8017", "pure_premium": 40.48657351694181}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 0.9702268888897648}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "5190", "loss_ratio": 1.1777135225692248}, {"class_code": "8820", "loss_ratio": 0.9483602193306517}, {"class_code": "8017", "loss_ratio": 0.9076906624533189}, {"class_code": "8810", "loss_ratio": 0.8312649398356425}, {"class_code": "5506", "loss_ratio": 0.4728708289721704}, {"class_code": "5183", "loss_ratio": 0.45277498811803457}, {"class_code": "8742", "loss_ratio": 0.02348753585584333}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "WA", "rate_per_exposure": 55.139586954698075}, {"state": "GA", "rate_per_exposure": 54.54256069367759}, {"state": "NY", "rate_per_exposure": 54.518606956743774}, {"state": "FL", "rate_per_exposure": 52.97042624267731}, {"state": "TN", "rate_per_exposure": 52.37930237156008}, {"state": "IN", "rate_per_exposure": 52.308985942855685}, {"state": "NC", "rate_per_exposure": 52.054673602394544}, {"state": "OH", "rate_per_exposure": 51.680488248218595}, {"state": "IL", "rate_per_exposure": 50.65911742832912}, {"state": "MO", "rate_per_exposure": 50.65709878122171}, {"state": "PA", "rate_per_exposure": 50.643798587113324}, {"state": "TX", "rate_per_exposure": 50.103654257545124}, {"state": "MA", "rate_per_exposure": 49.99654251470809}, {"state": "CA", "rate_per_exposure": 49.36846459984564}, {"state": "MD", "rate_per_exposure": 48.85429953475044}, {"state": "NJ", "rate_per_exposure": 48.34478955381774}, {"state": "WI", "rate_per_exposure": 48.03167994598623}, {"state": "VA", "rate_per_exposure": 47.88951174864707}, {"state": "MI", "rate_per_exposure": 46.5406529696297}, {"state": "AZ", "rate_per_exposure": 46.490531581590446}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total claim_count for Tennessee?", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE state = 'TN'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claim_count": 6644}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MD", "coverage_type": "Commercial Property", "frequency": 0.005651827092235917}, {"state": "MD", "coverage_type": "Workers Compensation", "frequency": 0.005394802870849437}, {"state": "MD", "coverage_type": "Commercial Auto", "frequency": 0.005104930991000689}, {"state": "MD", "coverage_type": "General Liability", "frequency": 0.004581416058435962}, {"state": "TN", "coverage_type": "General Liability", "frequency": 0.005702595453595276}, {"state": "TN", "coverage_type": "Commercial Property", "frequency": 0.00499713846913048}, {"state": "TN", "coverage_type": "Workers Compensation", "frequency": 0.004349168053315909}, {"state": "TN", "coverage_type": "Commercial Auto", "frequency": 0.004255940076363725}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 0.9702268888897648}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "severity": 8618.780662650603}, {"state": "OH", "severity": 8321.516827418865}, {"state": "AZ", "severity": 8304.086466542485}, {"state": "GA", "severity": 8130.045063752277}, {"state": "TN", "severity": 8106.376149909693}, {"state": "IN", "severity": 8073.489258026951}, {"state": "NJ", "severity": 7999.279705652105}, {"state": "IL", "severity": 7982.989693045563}, {"state": "MI", "severity": 7974.117879428014}, {"state": "MD", "severity": 7840.597223158217}, {"state": "VA", "severity": 7838.676272412708}, {"state": "CA", "severity": 7702.469082693948}, {"state": "NC", "severity": 7594.750243209097}, {"state": "WA", "severity": 7533.9472074468085}, {"state": "MO", "severity": 7528.200220658779}, {"state": "PA", "severity": 7433.6729395098455}, {"state": "TX", "severity": 7410.343162229739}, {"state": "NY", "severity": 7302.356212862635}, {"state": "MA", "severity": 7228.770247320693}, {"state": "WI", "severity": 7226.442057651027}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MD?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MD'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 4520.112904604051}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.5519841252784213}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5190 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND region = 'Midwest'", "ground_truth": {"success": true, "row_count": 1, "data": [{"avg_premium": 5053.702647663071}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "8742", "loss_ratio": 1.1127972040696357}, {"class_code": "5190", "loss_ratio": 0.7429355625999706}, {"class_code": "8017", "loss_ratio": 0.6507997552750892}, {"class_code": "5183", "loss_ratio": 0.6336105893041054}, {"class_code": "8820", "loss_ratio": 0.2932710583104704}, {"class_code": "9015", "loss_ratio": 0.2650446443076374}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "MA", "coverage_type": "General Liability", "frequency": 0.005757060987778602}, {"state": "MA", "coverage_type": "Workers Compensation", "frequency": 0.005476079556605489}, {"state": "MA", "coverage_type": "Commercial Property", "frequency": 0.00541962011636064}, {"state": "MA", "coverage_type": "Commercial Auto", "frequency": 0.005015564207657125}, {"state": "NJ", "coverage_type": "Commercial Auto", "frequency": 0.005491461772883499}, {"state": "NJ", "coverage_type": "General Liability", "frequency": 0.005103626110653521}, {"state": "NJ", "coverage_type": "Workers Compensation", "frequency": 0.00446541272447721}, {"state": "NJ", "coverage_type": "Commercial Property", "frequency": 0.004297790623458355}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IN", "loss_ratio": 0.8451870533933941}, {"state": "MI", "loss_ratio": 0.8445207747120288}, {"state": "TN", "loss_ratio": 0.8386586297203659}, {"state": "AZ", "loss_ratio": 0.831635010388349}, {"state": "GA", "loss_ratio": 0.8263554335781502}, {"state": "IL", "loss_ratio": 0.8241827644942115}, {"state": "VA", "loss_ratio": 0.8179525370618772}, {"state": "FL", "loss_ratio": 0.8166178755302055}, {"state": "PA", "loss_ratio": 0.8154947550450574}, {"state": "OH", "loss_ratio": 0.8117222401673373}, {"state": "MA", "loss_ratio": 0.7968066452180369}, {"state": "NJ", "loss_ratio": 0.786169360296659}, {"state": "MD", "loss_ratio": 0.7836179956874477}, {"state": "WI", "loss_ratio": 0.7798527515269952}, {"state": "TX", "loss_ratio": 0.7690328322938524}, {"state": "NY", "loss_ratio": 0.7575498625643559}, {"state": "CA", "loss_ratio": 0.7555582318282044}, {"state": "MO", "loss_ratio": 0.7525338450202093}, {"state": "WA", "loss_ratio": 0.738840684335971}, {"state": "NC", "loss_ratio": 0.7247153475929811}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8742'", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7579.262141712878}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8810", "pure_premium": 46.6503331702338}, {"class_code": "5506", "pure_premium": 44.484729929522004}, {"class_code": "8742", "pure_premium": 43.44431185542055}, {"class_code": "5183", "pure_premium": 40.931750337338926}, {"class_code": "8820", "pure_premium": 40.68693068322849}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for NC?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NC'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005215493577484546}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "IL", "paid_loss_ratio": 0.6656084286471571}, {"state": "WI", "paid_loss_ratio": 0.649880308491589}, {"state": "TX", "paid_loss_ratio": 0.6365016152009015}, {"state": "NJ", "paid_loss_ratio": 0.6334580352025554}, {"state": "TN", "paid_loss_ratio": 0.6252360868915836}, {"state": "GA", "paid_loss_ratio": 0.6228810480946463}, {"state": "MA", "paid_loss_ratio": 0.6140812956355586}, {"state": "VA", "paid_loss_ratio": 0.6088244274113939}, {"state": "MI", "paid_loss_ratio": 0.5982253384452179}, {"state": "IN", "paid_loss_ratio": 0.59453587121206}, {"state": "PA", "paid_loss_ratio": 0.5940486067034554}, {"state": "OH", "paid_loss_ratio": 0.5826399525883914}, {"state": "NY", "paid_loss_ratio": 0.5782333868674466}, {"state": "MO", "paid_loss_ratio": 0.574488033915724}, {"state": "FL", "paid_loss_ratio": 0.5721854822888148}, {"state": "MD", "paid_loss_ratio": 0.5629059676728803}, {"state": "NC", "paid_loss_ratio": 0.5610174722968836}, {"state": "CA", "paid_loss_ratio": 0.5525875028003563}, {"state": "AZ", "paid_loss_ratio": 0.5382113627590083}, {"state": "WA", "paid_loss_ratio": 0.5371712064131023}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IL", "coverage_type": "Workers Compensation", "frequency": 0.00540555548697377}, {"state": "IL", "coverage_type": "General Liability", "frequency": 0.004787550378600992}, {"state": "IL", "coverage_type": "Commercial Property", "frequency": 0.0047853414234455575}, {"state": "IL", "coverage_type": "Commercial Auto", "frequency": 0.004596174482039275}, {"state": "MD", "coverage_type": "Commercial Property", "frequency": 0.005651827092235917}, {"state": "MD", "coverage_type": "Workers Compensation", "frequency": 0.005394802870849437}, {"state": "MD", "coverage_type": "Commercial Auto", "frequency": 0.005104930991000689}, {"state": "MD", "coverage_type": "General Liability", "frequency": 0.004581416058435962}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "NY", "frequency": 0.005842334326428065}, {"state": "MO", "frequency": 0.005574913687116429}, {"state": "WA", "frequency": 0.005461830756764978}, {"state": "MA", "frequency": 0.005426997837813372}, {"state": "WI", "frequency": 0.005367470953357319}, {"state": "PA", "frequency": 0.005311015721486814}, {"state": "TX", "frequency": 0.005291255604370849}, {"state": "IN", "frequency": 0.005280053891509957}, {"state": "VA", "frequency": 0.005228301799223278}, {"state": "MI", "frequency": 0.0052237081448899434}, {"state": "GA", "frequency": 0.005220320158889982}, {"state": "NC", "frequency": 0.005215493577484546}, {"state": "MD", "frequency": 0.005198288015618081}, {"state": "FL", "frequency": 0.005068004590479151}, {"state": "OH", "frequency": 0.004964951276502602}, {"state": "CA", "frequency": 0.004891473180615508}, {"state": "IL", "frequency": 0.004851712206081064}, {"state": "NJ", "frequency": 0.0048100572988756096}, {"state": "TN", "frequency": 0.00480230474776852}, {"state": "AZ", "frequency": 0.004763301586225157}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "GA", "loss_ratio": 1.0101719691895696}, {"state": "AZ", "loss_ratio": 0.9579151462507872}, {"state": "MI", "loss_ratio": 0.9533556144230092}, {"state": "PA", "loss_ratio": 0.8505343909016583}, {"state": "WI", "loss_ratio": 0.838730323956497}, {"state": "FL", "loss_ratio": 0.8180285315113746}, {"state": "OH", "loss_ratio": 0.8176004022994984}, {"state": "VA", "loss_ratio": 0.7970956339206742}, {"state": "MD", "loss_ratio": 0.7943331637120552}, {"state": "IL", "loss_ratio": 0.7685659041172233}, {"state": "NC", "loss_ratio": 0.7684663500690676}, {"state": "MA", "loss_ratio": 0.7571219638875769}, {"state": "IN", "loss_ratio": 0.7525625191658051}, {"state": "WA", "loss_ratio": 0.7514195546774898}, {"state": "CA", "loss_ratio": 0.742192209276512}, {"state": "TN", "loss_ratio": 0.7359193768730046}, {"state": "NJ", "loss_ratio": 0.7312606005301295}, {"state": "TX", "loss_ratio": 0.7306013844436325}, {"state": "NY", "loss_ratio": 0.6806570816677591}, {"state": "MO", "loss_ratio": 0.6479270568581441}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 49.098322051228585}, {"class_code": "8017", "pure_premium": 45.87504837461007}, {"class_code": "5506", "pure_premium": 43.96659250422684}, {"class_code": "5183", "pure_premium": 43.34234216528388}, {"class_code": "8820", "pure_premium": 42.70456399968589}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8742", "pure_premium": 44.42204464474976}, {"class_code": "5506", "pure_premium": 43.60392917649229}, {"class_code": "5190", "pure_premium": 43.437078937146076}, {"class_code": "8820", "pure_premium": 41.1911920874482}, {"class_code": "8017", "pure_premium": 40.48657351694181}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "CA", "coverage_type": "Commercial Auto", "frequency": 0.005941177008251313}, {"state": "CA", "coverage_type": "General Liability", "frequency": 0.0057265264786480075}, {"state": "CA", "coverage_type": "Commercial Property", "frequency": 0.004655593641829234}, {"state": "CA", "coverage_type": "Workers Compensation", "frequency": 0.0039019040434759415}, {"state": "NY", "coverage_type": "Workers Compensation", "frequency": 0.0060797159640319474}, {"state": "NY", "coverage_type": "Commercial Auto", "frequency": 0.005893728231739281}, {"state": "NY", "coverage_type": "General Liability", "frequency": 0.005891627810555211}, {"state": "NY", "coverage_type": "Commercial Property", "frequency": 0.005466408228316761}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5506", "pure_premium": 55.8986367564513}, {"class_code": "8810", "pure_premium": 50.434807821313846}, {"class_code": "8820", "pure_premium": 47.326974642861}, {"class_code": "5190", "pure_premium": 45.19630613640151}, {"class_code": "5183", "pure_premium": 42.28105606745629}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "TN", "coverage_type": "General Liability", "frequency": 0.005702595453595276}, {"state": "TN", "coverage_type": "Commercial Property", "frequency": 0.00499713846913048}, {"state": "TN", "coverage_type": "Workers Compensation", "frequency": 0.004349168053315909}, {"state": "TN", "coverage_type": "Commercial Auto", "frequency": 0.004255940076363725}, {"state": "VA", "coverage_type": "General Liability", "frequency": 0.0054517622304382915}, {"state": "VA", "coverage_type": "Commercial Property", "frequency": 0.0053903701649545156}, {"state": "VA", "coverage_type": "Commercial Auto", "frequency": 0.0050556969278215}, {"state": "VA", "coverage_type": "Workers Compensation", "frequency": 0.004949386667644164}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 51.24461964357669}, {"class_code": "8017", "pure_premium": 45.34352326087986}, {"class_code": "8742", "pure_premium": 43.795096659749305}, {"class_code": "8810", "pure_premium": 43.64242009455048}, {"class_code": "5506", "pure_premium": 41.014829375242456}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "TX", "coverage_type": "Commercial Property", "frequency": 0.005787023880955479}, {"state": "TX", "coverage_type": "Commercial Auto", "frequency": 0.00541866466540174}, {"state": "TX", "coverage_type": "Workers Compensation", "frequency": 0.004993892847175561}, {"state": "TX", "coverage_type": "General Liability", "frequency": 0.00494819152181612}, {"state": "WA", "coverage_type": "Commercial Auto", "frequency": 0.006329788550197812}, {"state": "WA", "coverage_type": "Commercial Property", "frequency": 0.005438868989558347}, {"state": "WA", "coverage_type": "General Liability", "frequency": 0.005434264198009928}, {"state": "WA", "coverage_type": "Workers Compensation", "frequency": 0.004706871354840151}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8820", "pure_premium": 46.78005886503411}, {"class_code": "5506", "pure_premium": 43.68825442086105}, {"class_code": "8810", "pure_premium": 37.684764668798614}, {"class_code": "9015", "pure_premium": 37.06410294297614}, {"class_code": "8017", "pure_premium": 35.174899049762104}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in WI for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1118}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss trend by year for Massachusetts", "output": "SELECT policy_year, SUM(paid_loss) AS paid_loss\nFROM insurance_loss_data\nWHERE state = 'MA'\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "paid_loss": 10309284.41}, {"policy_year": 2020, "paid_loss": 6053426.62}, {"policy_year": 2021, "paid_loss": 10133244.87}, {"policy_year": 2022, "paid_loss": 5718617.21}, {"policy_year": 2023, "paid_loss": 8331555.63}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 50.5089744354891}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 1.0079648465898967}, {"region": "Northeast", "combined_ratio": 0.9956819755612396}, {"region": "South", "combined_ratio": 0.9843611730885826}, {"region": "Midwest", "combined_ratio": 0.9820660240008129}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in MO", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MO'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_written_premium": 12414267.15}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "8017", "pure_premium": 50.41652202564841}, {"class_code": "5190", "pure_premium": 48.97125789442456}, {"class_code": "8820", "pure_premium": 47.69389784008583}, {"class_code": "8742", "pure_premium": 43.375019262859325}, {"class_code": "9015", "pure_premium": 42.041863293961775}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.55242101992495}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MD?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MD'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7836179956874477}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5190 in TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND state = 'TX'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 46.66241626889979}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8810", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8810'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005071003329806581}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8017", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 42.61729710589817}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.7873688351977517}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Missouri for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2021", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_claims": 1274}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2023?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"paid_loss_ratio": 0.5991175843953596}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 49.098322051228585}, {"class_code": "8017", "pure_premium": 45.87504837461007}, {"class_code": "5506", "pure_premium": 43.96659250422684}, {"class_code": "5183", "pure_premium": 43.34234216528388}, {"class_code": "8820", "pure_premium": 42.70456399968589}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for WI in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"loss_ratio": 0.838730323956497}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IN", "coverage_type": "Workers Compensation", "frequency": 0.006140999961541943}, {"state": "IN", "coverage_type": "Commercial Auto", "frequency": 0.005220633794959725}, {"state": "IN", "coverage_type": "General Liability", "frequency": 0.005183853945184153}, {"state": "IN", "coverage_type": "Commercial Property", "frequency": 0.004623384416942954}, {"state": "NC", "coverage_type": "Commercial Property", "frequency": 0.005690826185417609}, {"state": "NC", "coverage_type": "Workers Compensation", "frequency": 0.00540485044455505}, {"state": "NC", "coverage_type": "General Liability", "frequency": 0.004989717003489062}, {"state": "NC", "coverage_type": "Commercial Auto", "frequency": 0.004935282997740556}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in MO", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"industry": "Construction", "total_claims": 1403}, {"industry": "Manufacturing", "total_claims": 1249}, {"industry": "Healthcare", "total_claims": 1025}, {"industry": "Retail", "total_claims": 920}, {"industry": "Hospitality", "total_claims": 897}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 6, "data": [{"class_code": "5183", "loss_ratio": 1.1871144244606733}, {"class_code": "8820", "loss_ratio": 1.0004275804089877}, {"class_code": "5190", "loss_ratio": 0.7331547506337119}, {"class_code": "8810", "loss_ratio": 0.6753687446125707}, {"class_code": "5506", "loss_ratio": 0.6528842213820653}, {"class_code": "9015", "loss_ratio": 0.42883713156939574}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in Florida?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'FL'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 32.85837515486968}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total exposure_units for MA?", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE state = 'MA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"total_exposure_units": 1341072.95}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 52.8902745517167}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for AZ in 2020", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2020", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5599.571826226871}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TN", "combined_ratio": 1.042555461606884}, {"state": "IN", "combined_ratio": 1.040405579015794}, {"state": "MI", "combined_ratio": 1.0395517437673527}, {"state": "IL", "combined_ratio": 1.0336624401898906}, {"state": "GA", "combined_ratio": 1.0276079461054288}, {"state": "AZ", "combined_ratio": 1.0247814893705967}, {"state": "OH", "combined_ratio": 1.0228017232578246}, {"state": "PA", "combined_ratio": 1.0157189355428249}, {"state": "FL", "combined_ratio": 1.0090584867010584}, {"state": "MA", "combined_ratio": 1.0090293731156201}, {"state": "VA", "combined_ratio": 1.0045414178584007}, {"state": "WI", "combined_ratio": 0.9806038774418532}, {"state": "NJ", "combined_ratio": 0.9797951796459586}, {"state": "MD", "combined_ratio": 0.9693476125381194}, {"state": "TX", "combined_ratio": 0.9692099622418223}, {"state": "NY", "combined_ratio": 0.963815907455949}, {"state": "MO", "combined_ratio": 0.9480706919528827}, {"state": "CA", "combined_ratio": 0.9312948882444255}, {"state": "WA", "combined_ratio": 0.925992064380495}, {"state": "NC", "combined_ratio": 0.9220555104929103}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for MA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 8258.673723986856}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for GA?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'", "ground_truth": {"success": true, "row_count": 1, "data": [{"expense_ratio": 0.18950862999652568}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "5190", "loss_ratio": 2.4775360017353383}, {"class_code": "9015", "loss_ratio": 1.5395755372376412}, {"class_code": "8017", "loss_ratio": 0.7174416625816417}, {"class_code": "5506", "loss_ratio": 0.6822979141179327}, {"class_code": "8810", "loss_ratio": 0.5473869295851361}, {"class_code": "8742", "loss_ratio": 0.443939203885203}, {"class_code": "8820", "loss_ratio": 0.00893116929935265}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for TX", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'TX'\nGROUP BY policy_year\nORDER BY policy_year", "ground_truth": {"success": true, "row_count": 5, "data": [{"policy_year": 2019, "earned_premium": 13981903.76}, {"policy_year": 2020, "earned_premium": 11872206.0}, {"policy_year": 2021, "earned_premium": 13189116.78}, {"policy_year": 2022, "earned_premium": 14513270.52}, {"policy_year": 2023, "earned_premium": 11958161.15}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 7, "data": [{"class_code": "8742", "loss_ratio": 1.5864675248344025}, {"class_code": "5190", "loss_ratio": 1.3000055686753231}, {"class_code": "5183", "loss_ratio": 1.2736901355156116}, {"class_code": "5506", "loss_ratio": 0.8833490764451069}, {"class_code": "8017", "loss_ratio": 0.8245777409429575}, {"class_code": "9015", "loss_ratio": 0.18646856740732473}, {"class_code": "8820", "loss_ratio": 0.14560631739423044}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8810", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'", "ground_truth": {"success": true, "row_count": 1, "data": [{"pure_premium": 40.58987210052513}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for OH in 2023", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2023", "ground_truth": {"success": true, "row_count": 1, "data": [{"rate_per_exposure": 66.65883872297431}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5", "ground_truth": {"success": true, "row_count": 5, "data": [{"class_code": "5190", "pure_premium": 51.24461964357669}, {"class_code": "8017", "pure_premium": 45.34352326087986}, {"class_code": "8742", "pure_premium": 43.795096659749305}, {"class_code": "8810", "pure_premium": 43.64242009455048}, {"class_code": "5506", "pure_premium": 41.014829375242456}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for NC?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NC'", "ground_truth": {"success": true, "row_count": 1, "data": [{"frequency": 0.005215493577484546}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "FL", "pure_premium": 43.68001996264619}, {"state": "NY", "pure_premium": 42.66280636621263}, {"state": "IN", "pure_premium": 42.62845837490903}, {"state": "GA", "pure_premium": 42.44143813899001}, {"state": "MO", "pure_premium": 41.96906644950354}, {"state": "MI", "pure_premium": 41.65446451508064}, {"state": "OH", "pure_premium": 41.315925594731176}, {"state": "WA", "pure_premium": 41.14914457747659}, {"state": "VA", "pure_premium": 40.98296525858418}, {"state": "MD", "pure_premium": 40.75768258043177}, {"state": "NC", "pure_premium": 39.61037111605624}, {"state": "AZ", "pure_premium": 39.55486823823268}, {"state": "PA", "pure_premium": 39.48035385012789}, {"state": "MA", "pure_premium": 39.23052050225903}, {"state": "TX", "pure_premium": 39.21001978745931}, {"state": "TN", "pure_premium": 38.929288671908814}, {"state": "WI", "pure_premium": 38.78771784056159}, {"state": "IL", "pure_premium": 38.731168534768486}, {"state": "NJ", "pure_premium": 38.47699373391945}, {"state": "CA", "pure_premium": 37.676420942517574}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'TX'", "ground_truth": {"success": true, "row_count": 1, "data": [{"severity": 7410.343162229739}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC", "ground_truth": {"success": true, "row_count": 4, "data": [{"region": "West", "combined_ratio": 0.9961589987091968}, {"region": "Northeast", "combined_ratio": 0.9947122414761608}, {"region": "Midwest", "combined_ratio": 0.9853533477001482}, {"region": "South", "combined_ratio": 0.9816885513851392}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'", "ground_truth": {"success": true, "row_count": 1, "data": [{"average_premium": 5224.368318238994}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 8, "data": [{"class_code": "8017", "loss_ratio": 1.4421529992706317}, {"class_code": "8742", "loss_ratio": 1.3222649694138893}, {"class_code": "5506", "loss_ratio": 1.1651611012791405}, {"class_code": "5183", "loss_ratio": 0.7558551413064204}, {"class_code": "8810", "loss_ratio": 0.6878169699944449}, {"class_code": "8820", "loss_ratio": 0.6590805507548743}, {"class_code": "5190", "loss_ratio": 0.490617947953014}, {"class_code": "9015", "loss_ratio": 0.2173679718075325}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000", "ground_truth": {"success": true, "row_count": 20, "data": [{"state": "TN", "average_premium": 5487.837104884514}, {"state": "WA", "average_premium": 5419.252912436548}, {"state": "PA", "average_premium": 5404.408096346849}, {"state": "GA", "average_premium": 5330.874493071984}, {"state": "AZ", "average_premium": 5270.510482822656}, {"state": "TX", "average_premium": 5195.763139375354}, {"state": "CA", "average_premium": 5187.9085968448735}, {"state": "IN", "average_premium": 5165.71814018043}, {"state": "VA", "average_premium": 5007.9261217645535}, {"state": "FL", "average_premium": 4993.662469619444}, {"state": "NY", "average_premium": 4971.202810725258}, {"state": "MO", "average_premium": 4912.066315152563}, {"state": "NC", "average_premium": 4811.4407468595355}, {"state": "IL", "average_premium": 4810.454197539957}, {"state": "MA", "average_premium": 4729.088077302864}, {"state": "OH", "average_premium": 4581.627278552834}, {"state": "MI", "average_premium": 4575.9549949924885}, {"state": "MD", "average_premium": 4520.112904604051}, {"state": "WI", "average_premium": 4516.574014858381}, {"state": "NJ", "average_premium": 4506.759422212862}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC", "ground_truth": {"success": true, "row_count": 8, "data": [{"state": "IN", "coverage_type": "Workers Compensation", "frequency": 0.006140999961541943}, {"state": "IN", "coverage_type": "Commercial Auto", "frequency": 0.005220633794959725}, {"state": "IN", "coverage_type": "General Liability", "frequency": 0.005183853945184153}, {"state": "IN", "coverage_type": "Commercial Property", "frequency": 0.004623384416942954}, {"state": "TN", "coverage_type": "General Liability", "frequency": 0.005702595453595276}, {"state": "TN", "coverage_type": "Commercial Property", "frequency": 0.00499713846913048}, {"state": "TN", "coverage_type": "Workers Compensation", "frequency": 0.004349168053315909}, {"state": "TN", "coverage_type": "Commercial Auto", "frequency": 0.004255940076363725}], "error": null}}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8810", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'", "ground_truth": {"success": true, "row_count": 1, "data": [{"combined_ratio": 1.0153420254864853}], "error": null}}
