{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium for Workers Compensation in Missouri", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for OH?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for GA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for NY?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for IN?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for FL in 2023", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Missouri", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total claim_count by state", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for MO?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total claim_count for NC?", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8017", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in Florida", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in VA", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for MD in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium for Workers Compensation in Washington", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8810", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5183", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for GA?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5190", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average earned_premium for class code 8742", "output": "SELECT AVG(earned_premium) AS avg_earned_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for MO?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for MI?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for WA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8017", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for MD in 2021", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for OH in 2023", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 9015", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5506", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total policy_count by state", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Michigan for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5190", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for CA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total earned_premium for Texas?", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for GA in 2020", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total written_premium for California?", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in OH for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in Georgia", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by paid_loss", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8017", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2019 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for NJ in 2020", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for OH?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for MA", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'MA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for TX?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for CA?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss trend by year for MD", "output": "SELECT policy_year, SUM(incurred_loss) AS incurred_loss\nFROM insurance_loss_data\nWHERE state = 'MD'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for FL", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'FL'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 9015 in Washington?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2023?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8017", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by paid_loss", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5506 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for WA in 2023", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2022?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for MA?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5190", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for NY?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8742", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8742", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for NC in 2020", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2023?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8017", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2020?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8017 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for GA in 2020", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for TX in 2019", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by policy_count", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2021?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for CA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for MD?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8810", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by policy_count", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 9015", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2022?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for FL in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8810 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8810' AND region = 'West'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for MD in 2022", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average earned_premium for class code 8810", "output": "SELECT AVG(earned_premium) AS avg_earned_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Wisconsin?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for WI in 2019", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total earned_premium for North Carolina?", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for TX in 2023", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5506", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total policy_count by state", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for MO?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for MA?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for NJ in 2020", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss trend by year for MA", "output": "SELECT policy_year, SUM(paid_loss) AS paid_loss\nFROM insurance_loss_data\nWHERE state = 'MA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for MD?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for AZ in 2023", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for MD?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Maryland", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MD'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average exposure_units for class code 8810", "output": "SELECT AVG(exposure_units) AS avg_exposure_units\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2022?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for NJ in 2019", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for CA in 2019", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for CA in 2020", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NC in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss for Workers Compensation in MA", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in VA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Virginia", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for Illinois", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'IL'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for MI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for WA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in Michigan", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for WA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8017", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for WI?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in North Carolina", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NC'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 9015", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5506", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for OH?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in MI", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MI'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2023?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for MI?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for MO in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for PA in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8820", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total earned_premium for Massachusetts?", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for IN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5190", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for AZ in 2022", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5506 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND region = 'West'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8810", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8810", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 9015", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total incurred_loss by state", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2020?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for WA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8742", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total earned_premium by state", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total claim_count for IN?", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss trend by year for PA", "output": "SELECT policy_year, SUM(paid_loss) AS paid_loss\nFROM insurance_loss_data\nWHERE state = 'PA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for GA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average claim_count for class code 9015", "output": "SELECT AVG(claim_count) AS avg_claim_count\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total written_premium for PA?", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8017", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by claim_count", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for WI in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for NY?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Indiana?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2020?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for OH in 2021", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for IL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5183", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8810", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for FL in 2019", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in AZ for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for Massachusetts?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5190", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Illinois", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'IL'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for MO?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5190 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for PA in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in FL", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'FL'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by paid_loss", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2022 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for TN in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for MD in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for AZ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by paid_loss", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for CA in 2019", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for WA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for AZ?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for MO?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for NJ?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2020?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5506", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Tennessee?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 5190", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for WA in 2020", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in Michigan", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5190", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Workers Compensation in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for FL in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for FL?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8017", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MO?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by earned_premium", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total policy_count for Indiana?", "output": "SELECT SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for TX?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5506 in FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for AZ in 2021", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8017 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in Washington?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8810", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in TN for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2021?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5506 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8017", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for FL in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5190", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2021?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5183", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in IL", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2022?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for MA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8742", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 9015 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2023?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for PA?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total earned_premium by state", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8820", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total incurred_loss by state", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2023?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5190", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for AZ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for MA in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8742 in Maryland?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8742", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in FL", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'FL'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for VA in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for MI in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for NJ in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Indiana?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2022?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in Massachusetts", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for IL?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for Washington", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'WA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for AZ in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8017", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for OH?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8810", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8017", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5506 in Pennsylvania?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average incurred_loss for class code 5506", "output": "SELECT AVG(incurred_loss) AS avg_incurred_loss\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8742 in Tennessee?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for PA in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count trend by year for Georgia", "output": "SELECT policy_year, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nWHERE state = 'GA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for TN in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for IN in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for NC?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for FL in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for MD in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2022 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 8017", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Massachusetts for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in CA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for VA in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for MO?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 9015", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for AZ?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 5190", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Michigan for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8742", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total paid_loss for WI?", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for FL", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'FL'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 9015", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total written_premium by state", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5183", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 9015 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8810", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss trend by year for Missouri", "output": "SELECT policy_year, SUM(paid_loss) AS paid_loss\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for TN in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5506", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for WI?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for FL?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for OH in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for IL?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 9015", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8820", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5506", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for OH in 2023", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NJ in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for IN in 2019", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 5506", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for VA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for Illinois?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8742", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average earned_premium for class code 8820", "output": "SELECT AVG(earned_premium) AS avg_earned_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8742", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for CA?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2023?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total earned_premium for Georgia?", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 8017", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total claim_count for Illinois?", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5183 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8017", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for TN?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2022?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8017", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8017", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for MO?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for Pennsylvania?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8742", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total paid_loss by state", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for IN in 2023", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 8810", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in NC", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NC'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for WI?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2019?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5190 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count trend by year for Maryland", "output": "SELECT policy_year, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nWHERE state = 'MD'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8017", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 9015 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for TX?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5506", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8820", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for AZ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for PA", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'PA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for IN?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2023?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5183", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Indiana", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'IN'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for WA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for OH?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Texas for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for MD?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5506 in IL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for NC?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total paid_loss for Michigan?", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in MI", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MI'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 8810", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8742 in GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5506", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for MI in 2019", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5190", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for GA", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'GA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in VA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count trend by year for Pennsylvania", "output": "SELECT policy_year, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nWHERE state = 'PA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total exposure_units for WI?", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by exposure_units", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for PA in 2023", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8810", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for GA in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for FL?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8742", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Tennessee for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for OH in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Wisconsin for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for MI in 2022", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total paid_loss by state", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8742", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units for Workers Compensation in Ohio", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for AZ in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by policy_count", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Tennessee", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TN'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MO?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8017", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for TX?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for IL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in Pennsylvania", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2019?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for NC?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total paid_loss by state", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for CA in 2023", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8017 in New York?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for OH?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for VA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for OH?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for VA", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MD?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2022?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for MI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in NJ for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in TN", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5183", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium for Workers Compensation in OH", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in Georgia", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2019?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for GA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for MD in 2020", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for IN in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8810", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for TX in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for FL?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8017 in Washington?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for PA?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5190", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in Georgia?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for TX in 2019", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for OH?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for IN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for AZ in 2020", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average policy_count for class code 5183", "output": "SELECT AVG(policy_count) AS avg_policy_count\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total policy_count by state", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for NJ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for PA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2021?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for VA?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8017", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5190", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average policy_count for class code 8742", "output": "SELECT AVG(policy_count) AS avg_policy_count\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2020?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Arizona?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for IL in 2023", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MO?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5183 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for New Jersey?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for NJ in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for MO?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for TX in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for NC?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for FL?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 9015", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for IN?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for OH in 2023", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2019?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for TX in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for MI in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for OH?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for CA in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count trend by year for MA", "output": "SELECT policy_year, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nWHERE state = 'MA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Workers Compensation in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'West'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Virginia for 2020?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NJ in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count trend by year for VA", "output": "SELECT policy_year, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8810", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for MA?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for MO in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for NJ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for IL in 2022", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2019?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for GA in 2022", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for IN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in MA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8742", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in Wisconsin?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for MO in 2020", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5506", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2020?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Workers Compensation in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8810", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8810 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8810' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5506", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Virginia?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5506", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average earned_premium for class code 8820", "output": "SELECT AVG(earned_premium) AS avg_earned_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for TX?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in New York for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for NC?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for GA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2022 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5190", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for CA in 2021", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for AZ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NC in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5190", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for VA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in WI for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2023?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5190", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in NC", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Workers Compensation in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 5183", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for OH?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for VA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for NY in 2021", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for GA", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'GA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for MD?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for MD in 2022", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5190", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 9015", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for VA in 2020", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for NC in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for WI?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 9015", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for OH?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for MI in 2021", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for GA in 2019", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for New Jersey?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for WI?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by paid_loss", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for VA?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2020?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2023?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for MA", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'MA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for NJ?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for MD in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8017", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by paid_loss", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in Ohio?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Arizona?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by policy_count", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for MA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8810", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for WI in 2023", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Arizona", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'AZ'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5190", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8742 in NY?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 5183", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for OH?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for IL?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total paid_loss for New Jersey?", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5506 in Missouri?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for FL?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for MO?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for PA in 2021", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8017", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for NY in 2022", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total earned_premium by state", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for NJ?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for CA", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2022 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 9015 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for TX?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8017", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total exposure_units for NC?", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for FL in 2020", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2021?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8820", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for NC?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for MO?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for VA in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2022?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in GA", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for TX?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for MO in 2022", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for PA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2019?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for PA in 2021", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average exposure_units for class code 9015", "output": "SELECT AVG(exposure_units) AS avg_exposure_units\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for PA?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total written_premium by state", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average earned_premium for class code 8810", "output": "SELECT AVG(earned_premium) AS avg_earned_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 8742", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in MO", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2022?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2021?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for NC in 2019", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2020?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for MD in 2020", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total earned_premium for Virginia?", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count for Workers Compensation in Tennessee", "output": "SELECT SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5190", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total exposure_units for WI?", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total paid_loss for MI?", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5190 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND region = 'West'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for AZ?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 9015 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total earned_premium for MD?", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for NC in 2019", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for PA in 2022", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for IL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 5190", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in New Jersey?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total incurred_loss by state", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8820", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in California for 2020?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for GA in 2021", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5190", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5183 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in TX for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by policy_count", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for NC", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'NC'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for NY?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total exposure_units for MO?", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for GA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8810", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in Massachusetts", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for NJ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for MD in 2019", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for GA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5190 in MA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average policy_count for class code 5190", "output": "SELECT AVG(policy_count) AS avg_policy_count\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in Georgia", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for MA in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2022?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2021?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2020?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in OH for 2020?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for VA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2021?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in GA for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in OH?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in Maryland?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NJ in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for NY?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in MO", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for MI in 2019", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for TX?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in MA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 5506", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2022?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for FL in 2020", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Illinois?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total claim_count by state", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Missouri", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for AZ in 2022", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8017", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in FL", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'FL'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2023?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Pennsylvania for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Georgia?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total paid_loss for Ohio?", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Michigan for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss for Workers Compensation in Indiana", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in North Carolina", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NC'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average claim_count for class code 8810", "output": "SELECT AVG(claim_count) AS avg_claim_count\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for TN?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NC in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5506", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in Ohio", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for FL in 2023", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5190 in Pennsylvania?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2022?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in IN for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5183", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for TX?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for PA in 2021", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average earned_premium for class code 5183", "output": "SELECT AVG(earned_premium) AS avg_earned_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 5183", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for NJ in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for PA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by exposure_units", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for NJ in 2023", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average claim_count for class code 5190", "output": "SELECT AVG(claim_count) AS avg_claim_count\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NJ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NJ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8820", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8017", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5190 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND region = 'West'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8810", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for TX in 2023", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5190", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for MI in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8810", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for IL in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for NY?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in TX", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for OH in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MO?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for GA?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in Michigan", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2020?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for IN?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average claim_count for class code 5506", "output": "SELECT AVG(claim_count) AS avg_claim_count\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count for Workers Compensation in MD", "output": "SELECT SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5506", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for NJ in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5506 in Arizona?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total paid_loss by state", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for TX in 2019", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average incurred_loss for class code 8017", "output": "SELECT AVG(incurred_loss) AS avg_incurred_loss\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8810", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for MO?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in New Jersey", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NJ'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8017 in FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total policy_count by state", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2021?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for OH?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total written_premium for Florida?", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for IL in 2023", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units for Workers Compensation in AZ", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2021?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 9015 in Indiana?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for VA in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total claim_count by state", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for NJ in 2020", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in GA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'GA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2022 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5506 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5190", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for FL in 2021", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in MA for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total claim_count by state", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for OH in 2021", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in Wisconsin?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for AZ?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for TX in 2020", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 5506", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for IL in 2019", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total claim_count for NC?", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8017 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND region = 'West'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average claim_count for class code 5190", "output": "SELECT AVG(claim_count) AS avg_claim_count\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Virginia for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for NJ?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5190", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Missouri", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total written_premium for Missouri?", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Georgia", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'GA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8017", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total exposure_units for California?", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in WA for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in CA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for AZ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for OH in 2020", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for MD?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for MD in 2020", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5190 in North Carolina?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total earned_premium by state", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for CA in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NC in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for TN in 2023", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5506", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for MA in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in GA", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in Tennessee", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in TX for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Texas?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in CA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8810", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Indiana", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'IN'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for MA?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for FL?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5190", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for MA?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Michigan for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for WI in 2020", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for NJ in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for TN", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'TN'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for MI in 2019", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2022?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for WA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 9015", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 5190", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for IN in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8017", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2022?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by exposure_units", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for OH in 2020", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss for Workers Compensation in CA", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for TN?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for AZ?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for TX?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for WI in 2021", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2021?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total incurred_loss for IN?", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 9015", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for CA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2022?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for IN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5183", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for IL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2022?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in New York?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8017 in NJ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for GA in 2022", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for GA?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2019 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average incurred_loss for class code 5190", "output": "SELECT AVG(incurred_loss) AS avg_incurred_loss\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for VA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2023?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in Maryland", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for MI in 2023", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8810", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for MI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in WA for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total incurred_loss by state", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5506", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for WA?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8810 in Washington?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8810' AND state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for MA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for MA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2019?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss for Workers Compensation in Indiana", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for OH in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for WA?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss trend by year for MD", "output": "SELECT policy_year, SUM(paid_loss) AS paid_loss\nFROM insurance_loss_data\nWHERE state = 'MD'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for IL?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for WI in 2020", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2021?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for OH in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for WI in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2019?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 8017", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for MA in 2019", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for MI in 2023", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2020?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5506", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2023?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2023?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8017", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for TX in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for MA in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in NJ", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NJ'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2021?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 9015", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2022?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2022?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for Arizona", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'AZ'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for IN in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Missouri?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for OH?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for OH in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for MO in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total earned_premium for IN?", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Missouri for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Massachusetts for 2019?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in PA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'PA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for PA?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for WA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for IL?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2023?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in OH", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'OH'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2021?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5506", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2021 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8742", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total policy_count for OH?", "output": "SELECT SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total policy_count by state", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Auto in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Auto' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Commercial Property in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Commercial Property' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8017", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total claim_count for FL?", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5183", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average claim_count for class code 8742", "output": "SELECT AVG(claim_count) AS avg_claim_count\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for OH in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for CA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MD?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in New York", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NY'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for MO?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for OH?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for Georgia", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'GA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for AZ?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in Virginia", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for GA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total written_premium by state", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8820", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for IL in 2021", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for CA in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Wisconsin?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for PA in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 9015 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total claim_count by state", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2023?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by claim_count", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2021?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in MO for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for WI in 2023", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for MD?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2022?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units for Workers Compensation in Wisconsin", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by earned_premium", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for CA in 2022", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for FL?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for VA?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by policy_count", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average exposure_units for class code 8810", "output": "SELECT AVG(exposure_units) AS avg_exposure_units\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2023?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for NC in 2023", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in California for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NY and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NY', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for WA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8810", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for TX?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for NJ?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5183", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2020?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total earned_premium by state", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total claim_count for Texas?", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for NC in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 8820", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for WI in 2019", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for MI?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8742", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for OH?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Michigan", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MI'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in CA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'CA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2019?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Tennessee for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for AZ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2020?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total earned_premium by state", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8017", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units for Workers Compensation in California", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in FL", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'FL'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for MO in 2023", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for WA in 2020", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 9015", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for VA in 2023", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for TN", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'TN'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2021?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for TN?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2020?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by earned_premium", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8810 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8810' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for WI", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'WI'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total earned_premium for IL?", "output": "SELECT SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for VA in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for CA in 2019", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss for Workers Compensation in PA", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for IN in 2021", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average policy_count for class code 8820", "output": "SELECT AVG(policy_count) AS avg_policy_count\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for WA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2020?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in MD", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MD'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for TN?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8810", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in FL for 2020?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for IL?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for AZ in 2021", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2019?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for MD in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for MO", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2020?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for VA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 5506", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for FL?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total paid_loss for North Carolina?", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for NC in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between AZ and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('AZ', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2019?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for GA in 2019", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for CA in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Indiana", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'IN'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2020?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2023?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5183", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for GA in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2022?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for AZ in 2023", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for IL in 2022", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Massachusetts for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for NY?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for OH in 2020", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in CA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2022?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in Florida", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for TN?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for NY?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in WA for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5506", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5190 in Pennsylvania?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for MO in 2022", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for CA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in Missouri?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for IL?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8810", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8742", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for NY in 2023", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8017 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5183", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8810 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8810' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Florida?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for WA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in NY", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NY'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2022?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for NJ in 2020", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for WA in 2020", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for New Jersey?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count for Workers Compensation in VA", "output": "SELECT SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2020?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5183 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for PA in 2022", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Illinois?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2023 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 8820", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for WA?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2020?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for CA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5506", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by exposure_units", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in Michigan", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5506", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for NY?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for VA", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count trend by year for Tennessee", "output": "SELECT policy_year, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nWHERE state = 'TN'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total written_premium for MA?", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for PA in 2023", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'PA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8810", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average earned_premium for class code 9015", "output": "SELECT AVG(earned_premium) AS avg_earned_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8017", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8017 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND region = 'West'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2023?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2022?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for IN in 2022", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for NY in 2023", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2022 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NC in 2022", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in California", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for TN?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in FL for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for PA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2023?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for WI in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for WA in 2021", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2023?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Massachusetts?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss trend by year for CA", "output": "SELECT policy_year, SUM(paid_loss) AS paid_loss\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2021?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2022?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for MO?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MO'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for TX?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for MI in 2020", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8742", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5183", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5506 in Ohio?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5506' AND state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for California?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for NY?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for MO in 2023", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for Illinois", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'IL'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 5183", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for NC?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for OH?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5183", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total paid_loss by state", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for GA in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for North Carolina", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'NC'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure for PA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for AZ?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total policy_count by state", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8017", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Ohio", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'OH'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for GA in 2023", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2019?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average written_premium for class code 9015", "output": "SELECT AVG(written_premium) AS avg_written_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total paid_loss by state", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Washington", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'WA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MD?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average claim_count for class code 5506", "output": "SELECT AVG(claim_count) AS avg_claim_count\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for GA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2019?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NJ and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NJ', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for OH?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in FL", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'FL'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by claim_count", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5190", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8742", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total policy_count by state", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the rate per exposure for NY in 2021", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for MA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Washington?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for MA in 2022", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average policy_count for class code 8017", "output": "SELECT AVG(policy_count) AS avg_policy_count\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for OH?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and MD by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'MD')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for TN in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Tennessee for 2022?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TN' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for North Carolina", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'NC'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for NC in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio in 2023?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for MD?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for VA in 2021", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'VA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for WI in 2023", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5506", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NC for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NC' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8017", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss for Workers Compensation in Wisconsin", "output": "SELECT SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2021?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for WA in 2023", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'WA' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8820", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for FL in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2019 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and MO by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'MO')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in MA", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MA'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by paid_loss", "output": "SELECT state, SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_paid_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2023?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for PA?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'PA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for AZ in 2021", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 5506", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for MI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2021?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 5190", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and TX by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'TX')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss trend by year for NY", "output": "SELECT policy_year, SUM(paid_loss) AS paid_loss\nFROM insurance_loss_data\nWHERE state = 'NY'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2020?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IN for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IN' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and WA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'WA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for MA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Indiana for 2021?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'IN' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for OH?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2019?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for WA?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for California?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2020 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between VA and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('VA', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2020?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for IN?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and IN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'IN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim_count trend by year for VA", "output": "SELECT policy_year, SUM(claim_count) AS claim_count\nFROM insurance_loss_data\nWHERE state = 'VA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for TX?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for MI?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by policy_count", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TN and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TN', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for OH", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'OH'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the South region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'South'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2020?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8017", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for VA?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for FL?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the total paid_loss for WA?", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE state = 'WA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8017", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for NJ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for OH?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for New York?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for General Liability in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'General Liability' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8810", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MO and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MO', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average paid_loss for class code 8742", "output": "SELECT AVG(paid_loss) AS avg_paid_loss\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show written_premium for Workers Compensation in Texas", "output": "SELECT SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for MO in 2020", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for MD?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MO for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MO' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for TX in 2022", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units for Workers Compensation in Florida", "output": "SELECT SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'FL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WI for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WI' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for MA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for OH?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'OH'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for Indiana?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 9015 in North Carolina?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND state = 'NC'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and NJ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'NJ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and OH by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'OH')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in Illinois for 2020?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in GA for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'GA' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for IN?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for NJ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for CA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by written_premium", "output": "SELECT state, SUM(written_premium) AS total_written_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_written_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total incurred_loss by state", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total incurred_loss by state", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8820 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for WI?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by incurred_loss", "output": "SELECT state, SUM(incurred_loss) AS total_incurred_loss\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_incurred_loss DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for IN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 8820", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8820", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5183", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for IL?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for OH in 2022", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MA for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MA' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8742 in MA?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND state = 'MA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim severity by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nGROUP BY state\nORDER BY severity DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Workers Compensation in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between OH and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('OH', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show pure premium for class code 9015", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2023?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for AZ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for CA in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss trend by year for New York", "output": "SELECT policy_year, SUM(paid_loss) AS paid_loss\nFROM insurance_loss_data\nWHERE state = 'NY'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2023?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average exposure_units for class code 8810", "output": "SELECT AVG(exposure_units) AS avg_exposure_units\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8742", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MI for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MI' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for NJ?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for Missouri", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'MO'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show exposure_units trend by year for TX", "output": "SELECT policy_year, SUM(exposure_units) AS exposure_units\nFROM insurance_loss_data\nWHERE state = 'TX'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show incurred_loss trend by year for New Jersey", "output": "SELECT policy_year, SUM(incurred_loss) AS incurred_loss\nFROM insurance_loss_data\nWHERE state = 'NJ'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WI and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WI', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and NY by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'NY')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8820", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency for IN?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in AZ for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'AZ' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 5506", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 5183", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for NC in 2021", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in WA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'WA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim frequency in 2022?", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for IL in 2021", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 9015", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Count policies by coverage type", "output": "SELECT coverage_type, SUM(policy_count) AS policy_count\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY policy_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for AZ?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 8017", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '8017'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for IN?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 5190 in the Midwest region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '5190' AND region = 'Midwest'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the paid loss ratio for AZ in 2022", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for TX?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio in 2022?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MA and CA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MA', 'CA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for TX?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for CA in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity for TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for IL?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'IL'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2019?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and TN by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'TN')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 5506", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '5506'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show policy_count for Workers Compensation in Arizona", "output": "SELECT SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for TX?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'TX'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio in 2020?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim frequency for GA in 2022", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for OH in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'OH' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim severity for class code 5183", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for CA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate severity for Workers Compensation in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IN and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IN', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the loss ratio for TN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'TN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for GA?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'GA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average premium by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY average_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio for CA?", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'CA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show expense ratio for class code 8810", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "How many claims in MD for 2023?", "output": "SELECT SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'MD' AND policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for CA in 2021", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'CA' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid loss ratio for class code 9015", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8810 in IN?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8810' AND state = 'IN'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2021?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between PA and WI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('PA', 'WI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between FL and NC by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('FL', 'NC')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate rate per exposure by state", "output": "SELECT state,\n    SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nGROUP BY state\nORDER BY rate_per_exposure DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the loss ratio for MI in 2020", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE state = 'MI' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2020", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2020\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for MI?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'MI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Northeast region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Northeast' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TN for 2020, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TN' \n    AND policy_year = 2020\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show earned_premium trend by year for CA", "output": "SELECT policy_year, SUM(earned_premium) AS earned_premium\nFROM insurance_loss_data\nWHERE state = 'CA'\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for MA in 2022", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MA' AND policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate average claim_count for class code 5190", "output": "SELECT AVG(claim_count) AS avg_claim_count\nFROM insurance_loss_data\nWHERE class_code = '5190'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between CA and VA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('CA', 'VA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for IL in 2020", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'IL' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for WI?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show paid_loss for Workers Compensation in Wisconsin", "output": "SELECT SUM(paid_loss) AS total_paid_loss\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' AND state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between NC and IL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('NC', 'IL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency for class code 8742", "output": "SELECT SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in OH for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'OH' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for NY?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 5183 in New Jersey?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '5183' AND state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in MD for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'MD' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the Midwest region for 2023", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'Midwest' AND policy_year = 2023\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total claim_count by state", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in TX for 2023, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'TX' \n    AND policy_year = 2023\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by earned_premium", "output": "SELECT state, SUM(earned_premium) AS total_earned_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_earned_premium DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8810", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate reserve ratio by state", "output": "SELECT state,\n    SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY reserve_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between TX and MI by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('TX', 'MI')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the expense ratio for AZ in 2021", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'AZ' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 9015", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '9015'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show claim frequency by coverage type", "output": "SELECT coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY coverage_type\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for NJ in 2021", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ' AND policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by claim_count", "output": "SELECT state, SUM(claim_count) AS total_claim_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_claim_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 10 states by policy_count", "output": "SELECT state, SUM(policy_count) AS total_policy_count\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_policy_count DESC\nLIMIT 10"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for AZ?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'AZ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8742 in the Northeast region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8742' AND region = 'Northeast'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2022 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2022\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show average premium for class code 8810", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between WA and MA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('WA', 'MA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2022", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2022\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the average premium for class 8017 in the West region?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS avg_premium\nFROM insurance_loss_data\nWHERE class_code = '8017' AND region = 'West'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio for VA?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'VA'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the claim severity in 2021?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE policy_year = 2021"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between GA and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('GA', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in NY for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'NY' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MI and PA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MI', 'PA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and AZ by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'AZ')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 9015 in WI?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '9015' AND state = 'WI'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show reserve ratio for class code 5183", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE class_code = '5183'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between IL and FL by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('IL', 'FL')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2023?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the reserve ratio for NY in 2020", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE state = 'NY' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in VA for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'VA' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show total exposure_units by state", "output": "SELECT state, SUM(exposure_units) AS total_exposure_units\nFROM insurance_loss_data\nGROUP BY state\nORDER BY total_exposure_units DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate loss ratio for 2019 by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2019\nGROUP BY state\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the paid loss ratio for NJ?", "output": "SELECT SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nWHERE state = 'NJ'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium for class code 8820 in MD?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE class_code = '8820' AND state = 'MD'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for NC in 2019", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'NC' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the combined ratio by region?", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY region\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in Texas", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'TX'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio by state", "output": "SELECT state,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY combined_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate paid loss ratio by state", "output": "SELECT state,\n    SUM(paid_loss) / NULLIF(SUM(earned_premium), 0) AS paid_loss_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY paid_loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the claim severity for FL in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(claim_count), 0) AS severity\nFROM insurance_loss_data\nWHERE state = 'FL' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Top 5 industries by claim count in NJ", "output": "SELECT industry, SUM(claim_count) AS total_claims\nFROM insurance_loss_data\nWHERE state = 'NJ'\nGROUP BY industry\nORDER BY total_claims DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the expense ratio for NY?", "output": "SELECT SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nWHERE state = 'NY'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in FL for 2019, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'FL' \n    AND policy_year = 2019\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show rate per exposure for class code 8742", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE class_code = '8742'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in PA for 2022, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'PA' \n    AND policy_year = 2022\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Which class codes have the highest loss ratio?", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY class_code\nHAVING SUM(earned_premium) > 0\nORDER BY loss_ratio DESC\nLIMIT 20"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the average premium for TX in 2020", "output": "SELECT SUM(written_premium) / NULLIF(SUM(policy_count), 0) AS average_premium\nFROM insurance_loss_data\nWHERE state = 'TX' AND policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare claim frequency between MD and GA by coverage type", "output": "SELECT state, coverage_type,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nWHERE state IN ('MD', 'GA')\nGROUP BY state, coverage_type\nORDER BY state, frequency DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate expense ratio by state", "output": "SELECT state,\n    SUM(expense) / NULLIF(SUM(written_premium), 0) AS expense_ratio\nFROM insurance_loss_data\nGROUP BY state\nORDER BY expense_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate claim frequency by state", "output": "SELECT state,\n    SUM(claim_count) / NULLIF(SUM(exposure_units), 0) AS frequency\nFROM insurance_loss_data\nGROUP BY state\nORDER BY frequency DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the South region for 2019", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'South' AND policy_year = 2019\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the reserve ratio in 2023?", "output": "SELECT SUM(reserved_loss) / NULLIF(SUM(incurred_loss), 0) AS reserve_ratio\nFROM insurance_loss_data\nWHERE policy_year = 2023"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate pure premium by state", "output": "SELECT state,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nGROUP BY state\nORDER BY pure_premium DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show combined ratio for class code 8810", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code = '8810'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show top 5 class codes by pure premium in the West region for 2021", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE region = 'West' AND policy_year = 2021\nGROUP BY class_code\nORDER BY pure_premium DESC\nLIMIT 5"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Compare loss ratio across years", "output": "SELECT policy_year,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nGROUP BY policy_year\nORDER BY policy_year"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate combined ratio for each region, excluding class code 8810", "output": "SELECT region,\n    (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE class_code != '8810'\nGROUP BY region\nORDER BY combined_ratio DESC"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for Workers Compensation in IL for 2021, grouped by class code", "output": "SELECT class_code,\n    SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE coverage_type = 'Workers Compensation' \n    AND state = 'IL' \n    AND policy_year = 2021\nGROUP BY class_code\nORDER BY loss_ratio DESC\nLIMIT 1000"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the pure premium for MO in 2019", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE state = 'MO' AND policy_year = 2019"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the rate per exposure in 2022?", "output": "SELECT SUM(written_premium) / NULLIF(SUM(exposure_units), 0) AS rate_per_exposure\nFROM insurance_loss_data\nWHERE policy_year = 2022"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "What is the pure premium in 2020?", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(exposure_units), 0) AS pure_premium\nFROM insurance_loss_data\nWHERE policy_year = 2020"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Show loss ratio for class code 8820", "output": "SELECT SUM(incurred_loss) / NULLIF(SUM(earned_premium), 0) AS loss_ratio\nFROM insurance_loss_data\nWHERE class_code = '8820'"}
{"instruction": "Convert the following insurance data query to ClickHouse SQL.\nTable: insurance_loss_data\nColumns: policy_id, claim_id, state, zip_code, class_code, class_group, coverage_type, \n         policy_year, accident_year, industry, region, written_premium, earned_premium,\n         incurred_loss, paid_loss, reserved_loss, exposure_units, claim_count, policy_count\n\nImportant: \n- Use SUM/SUM for ratios (NOT AVG of ratios)\n- Use NULLIF for division to prevent divide by zero\n- Include appropriate GROUP BY for aggregations", "input": "Calculate the combined ratio for GA in 2022", "output": "SELECT (SUM(incurred_loss) + SUM(expense)) / NULLIF(SUM(earned_premium), 0) AS combined_ratio\nFROM insurance_loss_data\nWHERE state = 'GA' AND policy_year = 2022"}
